Program.Sub.ScreenSU.Start
Gui.frmCRM..Create(BaseForm)
Gui.frmCRM..Size(15180,9870)
Gui.frmCRM..MinX(15180)
Gui.frmCRM..MinY(9870)
Gui.frmCRM..Position(0,0)
Gui.frmCRM..BackColor(-2147483633)
Gui.frmCRM..MousePointer(0)
Gui.frmCRM..Caption("CRM SalesSource")
Gui.frmCRM..Event(Resize,frmCRM_Resize)
Gui.frmCRM..Event(UnLoad,frmCRM_UnLoad)
Gui.frmCRM..AlwaysOnTop(False)
Gui.frmCRM..FontName("Tahoma")
Gui.frmCRM..FontSize(8.25)
Gui.frmCRM..ControlBox(True)
Gui.frmCRM..MaxButton(True)
Gui.frmCRM..MinButton(True)
Gui.frmCRM..Moveable(True)
Gui.frmCRM..Sizeable(True)
Gui.frmCRM..ShowInTaskBar(True)
Gui.frmCRM..TitleBar(True)
Gui.frmCRM.tabCRM.Create(Tab)
Gui.frmCRM.tabCRM.Size(14970,8475)
Gui.frmCRM.tabCRM.Position(75,1065)
Gui.frmCRM.tabCRM.Event(Click,tabCRM_Click)
Gui.frmCRM.tabCRM.Enabled(True)
Gui.frmCRM.tabCRM.Visible(True)
Gui.frmCRM.tabCRM.Zorder(0)
Gui.frmCRM.tabCRM.FontName("Tahoma")
Gui.frmCRM.tabCRM.FontSize(7.8)
Gui.frmCRM.tabCRM.Tabs(6)
Gui.frmCRM.tabCRM.SetTab(0)
Gui.frmCRM.tabCRM.Caption("Sales History")
Gui.frmCRM.tabCRM.SetTab(1)
Gui.frmCRM.tabCRM.Caption("Sales Orders")
Gui.frmCRM.tabCRM.SetTab(2)
Gui.frmCRM.tabCRM.Caption("Quotes")
Gui.frmCRM.tabCRM.SetTab(3)
Gui.frmCRM.tabCRM.Caption("Opportunities")
Gui.frmCRM.tabCRM.SetTab(4)
Gui.frmCRM.tabCRM.Caption("Events")
Gui.frmCRM.tabCRM.SetTab(5)
Gui.frmCRM.tabCRM.Caption("Notes")
Gui.frmCRM.GsGCNotes.Create(GsGridControl)
Gui.frmCRM.GsGCNotes.Size(14835,8040)
Gui.frmCRM.GsGCNotes.Position(0,0)
Gui.frmCRM.GsGCNotes.Parent("tabCRM",5)
Gui.frmCRM.GsGCNotes.Event(RowCellClick,GsGCNotes_RowCellClick)
Gui.frmCRM.GsGCNotes.Enabled(True)
Gui.frmCRM.GsGCNotes.Visible(True)
Gui.frmCRM.GsGCNotes.Zorder(0)
Gui.frmCRM.GsGCEvents.Create(GsGridControl)
Gui.frmCRM.GsGCEvents.Size(14835,8040)
Gui.frmCRM.GsGCEvents.Position(0,0)
Gui.frmCRM.GsGCEvents.Parent("tabCRM",4)
Gui.frmCRM.GsGCEvents.Event(RowCellClick,GsGCEvents_RowCellClick)
Gui.frmCRM.GsGCEvents.Enabled(True)
Gui.frmCRM.GsGCEvents.Visible(True)
Gui.frmCRM.GsGCEvents.Zorder(0)
Gui.frmCRM.GsGCSalesHist.Create(GsGridControl)
Gui.frmCRM.GsGCSalesHist.Size(14835,8040)
Gui.frmCRM.GsGCSalesHist.Position(0,0)
Gui.frmCRM.GsGCSalesHist.Parent("tabCRM",0)
Gui.frmCRM.GsGCSalesHist.Event(RowCellClick,GsGCSalesHist_RowCellClick)
Gui.frmCRM.GsGCSalesHist.Enabled(True)
Gui.frmCRM.GsGCSalesHist.Visible(True)
Gui.frmCRM.GsGCSalesHist.Zorder(0)
Gui.frmCRM.GsGCSalesOrders.Create(GsGridControl)
Gui.frmCRM.GsGCSalesOrders.Size(14835,8040)
Gui.frmCRM.GsGCSalesOrders.Position(0,0)
Gui.frmCRM.GsGCSalesOrders.Parent("tabCRM",1)
Gui.frmCRM.GsGCSalesOrders.Event(RowCellClick,GsGCSalesOrders_RowCellClick)
Gui.frmCRM.GsGCSalesOrders.Event(CellValueChanged,GsGCSalesOrders_CellValueChanged)
Gui.frmCRM.GsGCSalesOrders.Enabled(True)
Gui.frmCRM.GsGCSalesOrders.Visible(True)
Gui.frmCRM.GsGCSalesOrders.Zorder(0)
Gui.frmCRM.GsGCQuotes.Create(GsGridControl)
Gui.frmCRM.GsGCQuotes.Size(14835,8040)
Gui.frmCRM.GsGCQuotes.Position(0,0)
Gui.frmCRM.GsGCQuotes.Parent("tabCRM",2)
Gui.frmCRM.GsGCQuotes.Event(RowCellClick,GsGCQuotes_RowCellClick)
Gui.frmCRM.GsGCQuotes.Event(CellValueChanged,GsGCQuotes_CellValueChanged)
Gui.frmCRM.GsGCQuotes.Enabled(True)
Gui.frmCRM.GsGCQuotes.Visible(True)
Gui.frmCRM.GsGCQuotes.Zorder(0)
Gui.frmCRM.gsChartOpp1.Create(gschart)
Gui.frmCRM.gsChartOpp1.Size(7455,3585)
Gui.frmCRM.gsChartOpp1.Position(0,4350)
Gui.frmCRM.gsChartOpp1.Parent("tabCRM",3)
Gui.frmCRM.gsChartOpp1.Enabled(True)
Gui.frmCRM.gsChartOpp1.Visible(True)
Gui.frmCRM.gsChartOpp1.Zorder(0)
Gui.frmCRM.gsChartOpp2.Create(gschart)
Gui.frmCRM.gsChartOpp2.Size(7455,3585)
Gui.frmCRM.gsChartOpp2.Position(7515,4350)
Gui.frmCRM.gsChartOpp2.Parent("tabCRM",3)
Gui.frmCRM.gsChartOpp2.Enabled(True)
Gui.frmCRM.gsChartOpp2.Visible(True)
Gui.frmCRM.gsChartOpp2.Zorder(0)
Gui.frmCRM.GsGCOppor.Create(GsGridControl)
Gui.frmCRM.GsGCOppor.Size(14970,4305)
Gui.frmCRM.GsGCOppor.Position(0,0)
Gui.frmCRM.GsGCOppor.Parent("tabCRM",3)
Gui.frmCRM.GsGCOppor.Event(RowCellClick,gsgcOpp_RowCellClick)
Gui.frmCRM.GsGCOppor.Enabled(True)
Gui.frmCRM.GsGCOppor.Visible(True)
Gui.frmCRM.GsGCOppor.Zorder(0)
Gui.frmCRM.pbStatus.Create(ProgressBar)
Gui.frmCRM.pbStatus.Size(2490,240)
Gui.frmCRM.pbStatus.Position(9690,765)
Gui.frmCRM.pbStatus.Visible(False)
Gui.frmCRM.pbStatus.Max(100)
Gui.frmCRM.lblStatus.Create(Label,"****Change****",False,1260,240,0,9765,480,True,0,"Arial",8,-2147483633,0,0)
Gui.frmCRM.lblStatus.BorderStyle(0)
Gui.frmCRM.picGSSLogo.Create(PictureBox)
Gui.frmCRM.picGSSLogo.Size(4125,960)
Gui.frmCRM.picGSSLogo.Position(5490,45)
Gui.frmCRM.picGSSLogo.Event(DblClick,picGSSLogo_DblClick)
Gui.frmCRM.picGSSLogo.ToolTip("Double-Click for additional functions")
Gui.frmCRM.picGSSLogo.Enabled(True)
Gui.frmCRM.picGSSLogo.Visible(True)
Gui.frmCRM.picGSSLogo.Zorder(0)
Gui.frmCRM.framePermissions.Create(Frame)
Gui.frmCRM.framePermissions.Size(1965,390)
Gui.frmCRM.framePermissions.Position(13080,15)
Gui.frmCRM.framePermissions.Enabled(True)
Gui.frmCRM.framePermissions.Visible(True)
Gui.frmCRM.framePermissions.Zorder(0)
Gui.frmCRM.framePermissions.Caption("")
Gui.frmCRM.framePermissions.FontName("Tahoma")
Gui.frmCRM.framePermissions.FontSize(7.8)
Gui.frmCRM.optEdit.Create(Option)
Gui.frmCRM.optEdit.Enabled(False)
Gui.frmCRM.optEdit.Size(690,195)
Gui.frmCRM.optEdit.Position(1050,150)
Gui.frmCRM.optEdit.Caption("Edit")
Gui.frmCRM.optEdit.Parent("framePermissions")
Gui.frmCRM.optEdit.Visible(True)
Gui.frmCRM.optEdit.Zorder(0)
Gui.frmCRM.optEdit.FontName("Tahoma")
Gui.frmCRM.optEdit.FontSize(7.8)
Gui.frmCRM.optView.Create(Option)
Gui.frmCRM.optView.Size(690,195)
Gui.frmCRM.optView.Position(225,150)
Gui.frmCRM.optView.Caption("View")
Gui.frmCRM.optView.BackColor(15790320)
Gui.frmCRM.optView.ForeColor(0)
Gui.frmCRM.optView.Parent("framePermissions")
Gui.frmCRM.optView.Enabled(True)
Gui.frmCRM.optView.Visible(True)
Gui.frmCRM.optView.Zorder(0)
Gui.frmCRM.optView.FontName("Tahoma")
Gui.frmCRM.optView.FontSize(7.8)
Gui.frmCRM.framePermissions1.Create(Frame)
Gui.frmCRM.framePermissions1.Visible(False)
Gui.frmCRM.framePermissions1.Size(2745,390)
Gui.frmCRM.framePermissions1.Position(12300,15)
Gui.frmCRM.framePermissions1.Enabled(True)
Gui.frmCRM.framePermissions1.Zorder(0)
Gui.frmCRM.framePermissions1.Caption("")
Gui.frmCRM.framePermissions1.FontName("Tahoma")
Gui.frmCRM.framePermissions1.FontSize(7.8)
Gui.frmCRM.optView1.Create(Option)
Gui.frmCRM.optView1.Size(795,195)
Gui.frmCRM.optView1.Position(225,150)
Gui.frmCRM.optView1.Caption("View")
Gui.frmCRM.optView1.Parent("framePermissions1")
Gui.frmCRM.optView1.Enabled(True)
Gui.frmCRM.optView1.Visible(True)
Gui.frmCRM.optView1.Zorder(0)
Gui.frmCRM.optView1.FontName("Tahoma")
Gui.frmCRM.optView1.FontSize(7.8)
Gui.frmCRM.optShip1.Create(Option)
Gui.frmCRM.optShip1.Enabled(False)
Gui.frmCRM.optShip1.Size(795,195)
Gui.frmCRM.optShip1.Position(1890,150)
Gui.frmCRM.optShip1.Caption("Ship")
Gui.frmCRM.optShip1.Parent("framePermissions1")
Gui.frmCRM.optShip1.Visible(True)
Gui.frmCRM.optShip1.Zorder(0)
Gui.frmCRM.optShip1.FontName("Tahoma")
Gui.frmCRM.optShip1.FontSize(7.8)
Gui.frmCRM.optEdit1.Create(Option)
Gui.frmCRM.optEdit1.Enabled(False)
Gui.frmCRM.optEdit1.Size(795,195)
Gui.frmCRM.optEdit1.Position(1095,150)
Gui.frmCRM.optEdit1.Caption("Edit")
Gui.frmCRM.optEdit1.Parent("framePermissions1")
Gui.frmCRM.optEdit1.Visible(True)
Gui.frmCRM.optEdit1.Zorder(0)
Gui.frmCRM.optEdit1.FontName("Tahoma")
Gui.frmCRM.optEdit1.FontSize(7.8)
Gui.frmCRM.framePermissions2.Create(Frame)
Gui.frmCRM.framePermissions2.Size(2745,390)
Gui.frmCRM.framePermissions2.Position(12300,15)
Gui.frmCRM.framePermissions2.Size(2745,390)
Gui.frmCRM.framePermissions2.Position(12300,15)
Gui.frmCRM.framePermissions2.Visible(False)
Gui.frmCRM.framePermissions2.Enabled(True)
Gui.frmCRM.framePermissions2.Zorder(0)
Gui.frmCRM.framePermissions2.Caption("")
Gui.frmCRM.framePermissions2.FontName("Tahoma")
Gui.frmCRM.framePermissions2.FontSize(7.8)
Gui.frmCRM.optWLC.Create(Option)
Gui.frmCRM.optWLC.Enabled(False)
Gui.frmCRM.optWLC.Size(795,195)
Gui.frmCRM.optWLC.Position(1890,150)
Gui.frmCRM.optWLC.Parent("framePermissions2")
Gui.frmCRM.optWLC.Caption("W/L/C")
Gui.frmCRM.optWLC.Visible(True)
Gui.frmCRM.optWLC.Zorder(0)
Gui.frmCRM.optWLC.FontName("Tahoma")
Gui.frmCRM.optWLC.FontSize(7.8)
Gui.frmCRM.optEdit2.Create(Option)
Gui.frmCRM.optEdit2.Size(645,195)
Gui.frmCRM.optEdit2.Position(1095,150)
Gui.frmCRM.optEdit2.Caption("Edit")
Gui.frmCRM.optEdit2.Enabled(False)
Gui.frmCRM.optEdit2.Parent("framePermissions2")
Gui.frmCRM.optEdit2.Visible(True)
Gui.frmCRM.optEdit2.Zorder(0)
Gui.frmCRM.optEdit2.FontName("Tahoma")
Gui.frmCRM.optEdit2.FontSize(7.8)
Gui.frmCRM.optView2.Create(Option)
Gui.frmCRM.optView2.Size(690,195)
Gui.frmCRM.optView2.Position(225,150)
Gui.frmCRM.optView2.Caption("View")
Gui.frmCRM.optView2.Parent("framePermissions2")
Gui.frmCRM.optView2.Enabled(True)
Gui.frmCRM.optView2.Visible(True)
Gui.frmCRM.optView2.Zorder(0)
Gui.frmCRM.optView2.FontName("Tahoma")
Gui.frmCRM.optView2.FontSize(7.8)
Gui.frmCRM.frameOpts.Create(Frame)
Gui.frmCRM.frameOpts.Size(2775,1005)
Gui.frmCRM.frameOpts.Position(75,15)
Gui.frmCRM.frameOpts.Caption("Search By")
Gui.frmCRM.frameOpts.Enabled(True)
Gui.frmCRM.frameOpts.Visible(True)
Gui.frmCRM.frameOpts.Zorder(0)
Gui.frmCRM.frameOpts.FontName("Tahoma")
Gui.frmCRM.frameOpts.FontSize(7.8)
Gui.frmCRM.ddlOpts.Create(DropDownList)
Gui.frmCRM.ddlOpts.Size(2610,330)
Gui.frmCRM.ddlOpts.Position(90,225)
Gui.frmCRM.ddlOpts.Parent("frameOpts")
Gui.frmCRM.ddlOpts.Enabled(True)
Gui.frmCRM.ddlOpts.Visible(True)
Gui.frmCRM.ddlOpts.Zorder(0)
Gui.frmCRM.ddlOpts.FontName("Tahoma")
Gui.frmCRM.ddlOpts.FontSize(7.8)
Gui.frmCRM.ddlOpts.Event(SelectedIndexChanged,SelectOpts)
Gui.frmCRM.cboPart.Create(ComboBox)
Gui.frmCRM.cboPart.Size(2610,330)
Gui.frmCRM.cboPart.Position(90,600)
Gui.frmCRM.cboPart.Parent("frameOpts")
Gui.frmCRM.cboPart.Enabled(False)
Gui.frmCRM.cboPart.Event(Click,cboPart_Click)
Gui.frmCRM.cboPart.Visible(False)
Gui.frmCRM.cboPart.Zorder(0)
Gui.frmCRM.cboPart.FontName("Tahoma")
Gui.frmCRM.cboPart.FontSize(7.8)
Gui.frmCRM.cboContact.Create(ComboBox)
Gui.frmCRM.cboContact.Size(2610,330)
Gui.frmCRM.cboContact.Position(90,600)
Gui.frmCRM.cboContact.Parent("frameOpts")
Gui.frmCRM.cboContact.Enabled(False)
Gui.frmCRM.cboContact.Event(Click,cboContact_Click)
Gui.frmCRM.cboContact.Visible(False)
Gui.frmCRM.cboContact.Zorder(0)
Gui.frmCRM.cboContact.FontName("Tahoma")
Gui.frmCRM.cboContact.FontSize(7.8)
Gui.frmCRM.cboCust.Create(ComboBox)
Gui.frmCRM.cboCust.Size(2610,330)
Gui.frmCRM.cboCust.Position(90,600)
Gui.frmCRM.cboCust.Parent("frameOpts")
Gui.frmCRM.cboCust.Enabled(False)
Gui.frmCRM.cboCust.Event(Click,cboCust_Click)
Gui.frmCRM.cboCust.Visible(False)
Gui.frmCRM.cboCust.Zorder(0)
Gui.frmCRM.cboCust.FontName("Tahoma")
Gui.frmCRM.cboCust.FontSize(7.8)
Gui.frmCRM.cboSP.Create(ComboBox)
Gui.frmCRM.cboSP.Size(2610,330)
Gui.frmCRM.cboSP.Position(90,600)
Gui.frmCRM.cboSP.Parent("frameOpts")
Gui.frmCRM.cboSP.Enabled(False)
Gui.frmCRM.cboSP.Event(Click,cboSP_Click)
Gui.frmCRM.cboSP.Visible(False)
Gui.frmCRM.cboSP.Zorder(0)
Gui.frmCRM.cboSP.FontName("Tahoma")
Gui.frmCRM.cboSP.FontSize(7.8)
Gui.frmCRM.lblDays.Create(Label,"Days:",False,525,255,0,2925,225,True,0,"Arial",8,-2147483633,0,0)
Gui.frmCRM.lblDays.BorderStyle(0)
Gui.frmCRM.txtDays.Create(TextBox,"",False,510,300,0,3465,150,True,0,"Arial",8,-2147483643,1)
Gui.frmCRM.txtDays.Event(KeyPressEnter,LoadQuotes)
Gui.frmCRM.cmdLoadData.Create(Button)
Gui.frmCRM.cmdLoadData.Enabled(True)
Gui.frmCRM.cmdLoadData.Visible(True)
Gui.frmCRM.cmdLoadData.Zorder(0)
Gui.frmCRM.cmdLoadData.Size(765,375)
Gui.frmCRM.cmdLoadData.Position(2925,600)
Gui.frmCRM.cmdLoadData.Caption("REFRESH")
Gui.frmCRM.cmdLoadData.FontName("Tahoma")
Gui.frmCRM.cmdLoadData.FontSize(7.8)
Gui.frmCRM.cmdLoadData.Event(Click,cmdLoadData_Click)
Gui.frmWeb..Create(BaseForm)
Gui.frmWeb..Caption("Global Shop Solutions - Web Sites")
Gui.frmWeb..Size(3990,1665)
Gui.frmWeb..MinX(0)
Gui.frmWeb..MinY(0)
Gui.frmWeb..Position(0,0)
Gui.frmWeb..BackColor(-2147483633)
Gui.frmWeb..MousePointer(0)
Gui.frmWeb..MaxButton(False)
Gui.frmWeb..Sizeable(False)
Gui.frmWeb..Event(UnLoad,frmWeb_UnLoad)
Gui.frmWeb..MinButton(False)
Gui.frmWeb..AlwaysOnTop(False)
Gui.frmWeb..FontName("Tahoma")
Gui.frmWeb..FontSize(8.25)
Gui.frmWeb..ControlBox(True)
Gui.frmWeb..Moveable(True)
Gui.frmWeb..ShowInTaskBar(True)
Gui.frmWeb..TitleBar(True)
Gui.frmWeb.cmdGSS.Create(Button)
Gui.frmWeb.cmdGSS.Size(3615,375)
Gui.frmWeb.cmdGSS.Position(120,45)
Gui.frmWeb.cmdGSS.Caption("Global Shop Solutions")
Gui.frmWeb.cmdGSS.Event(Click,cmdGSS_Click)
Gui.frmWeb.cmdGSS.Enabled(True)
Gui.frmWeb.cmdGSS.Visible(True)
Gui.frmWeb.cmdGSS.Zorder(0)
Gui.frmWeb.cmdGSS.FontName("Tahoma")
Gui.frmWeb.cmdGSS.FontSize(7.8)
Gui.frmWeb.cmdServ.Create(Button)
Gui.frmWeb.cmdServ.Size(3615,375)
Gui.frmWeb.cmdServ.Position(120,450)
Gui.frmWeb.cmdServ.Caption("ServiceWeb")
Gui.frmWeb.cmdServ.Event(Click,cmdServ_Click)
Gui.frmWeb.cmdServ.Enabled(True)
Gui.frmWeb.cmdServ.Visible(True)
Gui.frmWeb.cmdServ.Zorder(0)
Gui.frmWeb.cmdServ.FontName("Tahoma")
Gui.frmWeb.cmdServ.FontSize(7.8)
Gui.frmWeb.cmdUpd.Create(Button)
Gui.frmWeb.cmdUpd.Size(3615,375)
Gui.frmWeb.cmdUpd.Position(120,855)
Gui.frmWeb.cmdUpd.Caption("GSS Updates")
Gui.frmWeb.cmdUpd.Event(Click,cmdUpd_Click)
Gui.frmWeb.cmdUpd.Enabled(True)
Gui.frmWeb.cmdUpd.Visible(True)
Gui.frmWeb.cmdUpd.Zorder(0)
Gui.frmWeb.cmdUpd.FontName("Tahoma")
Gui.frmWeb.cmdUpd.FontSize(7.8)
Gui.frmNotes..Create(BaseForm)
Gui.frmNotes..Caption("Notes: ")
Gui.frmNotes..Size(14460,7425)
Gui.frmNotes..MinX(0)
Gui.frmNotes..MinY(0)
Gui.frmNotes..Position(0,0)
Gui.frmNotes..BackColor(-2147483633)
Gui.frmNotes..MousePointer(0)
Gui.frmNotes..Event(UnLoad,frmNotes_UnLoad)
Gui.frmNotes..AlwaysOnTop(False)
Gui.frmNotes..FontName("Tahoma")
Gui.frmNotes..FontSize(8.25)
Gui.frmNotes..ControlBox(True)
Gui.frmNotes..MaxButton(True)
Gui.frmNotes..MinButton(True)
Gui.frmNotes..Moveable(True)
Gui.frmNotes..Sizeable(True)
Gui.frmNotes..ShowInTaskBar(True)
Gui.frmNotes..TitleBar(True)
Gui.frmNotes.GsGCNotes.Create(GsGridControl)
Gui.frmNotes.GsGCNotes.Size(14310,7125)
Gui.frmNotes.GsGCNotes.Position(0,0)
Gui.frmNotes.GsGCNotes.Event(CellValueChanged,GsGCNotes_CellValueChanged)
Gui.frmNotes.GsGCNotes.Enabled(True)
Gui.frmNotes.GsGCNotes.Visible(True)
Gui.frmNotes.GsGCNotes.Zorder(0)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
	V.Global.sFieldName.Declare
	V.Global.sData.Declare
	V.Global.sCustomers.Declare
	V.Global.bLoadData.Declare
	V.Global.sNTSaleperson.Declare
	V.Global.sNTSalepersonName.Declare
	V.Global.sNTCustomer.Declare
	V.Global.sNTCustomerName.Declare
	V.Global.sNTPart.Declare
	V.Global.sNTLoc.Declare
	V.Global.bAdmin.Declare
	V.Global.sSPID.Declare
	V.Global.sLoc.Declare
	V.Global.bLongPart.Declare
Program.Sub.Preflight.End

Program.Sub.Main.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.bGroup.Declare
	V.Local.sIcon.Declare
	V.Local.sGssLogo.Declare

	F.Intrinsic.String.Build("{0}\GAB\GAS\gss2.ico",V.Caller.PluginsDir,v.Local.sIcon)
	F.Intrinsic.String.Build("{0}\GAB\GAS\GAB_GSS_Logo_Green_Dash.png",V.Caller.PluginsDir,V.Local.sGssLogo)
	Gui.frmWeb..Icon(V.Local.sIcon)
	Gui.frmCRM..Icon(V.Local.sIcon)
	Gui.frmNotes..Icon(V.Local.sIcon)
	Gui.frmCRM.picGSSLogo.Picture(V.Local.sGssLogo)

	Gui.frmCRM.optView.Value(True)
	Gui.frmCRM.optView1.Value(True)
	Gui.frmCRM.optView2.Value(True)
	
	F.Intrinsic.Control.CallSub(CheckTable)
	F.Intrinsic.Control.CallSub(CheckSecurity)
	F.Intrinsic.Control.CallSub(SetAnchors)
	F.Intrinsic.Control.CallSub(CheckLongPart)
	F.Intrinsic.Control.CallSub(SetContextMenus)

	F.Global.Security.IsInGroup(V.Caller.User,"EditCRM",V.Caller.CompanyCode,V.Local.bGroup)
	F.Intrinsic.Control.If(V.Local.bGroup)
		Gui.frmCRM.optEdit.Enabled(True)
		Gui.frmCRM.optEdit1.Enabled(True)
		Gui.frmCRM.optEdit2.Enabled(True)
		Gui.frmCRM.optShip1.Enabled(True)
		Gui.frmCRM.optWLC.Enabled(True)
	F.Intrinsic.Control.EndIf

	Gui.frmCRM.tabCRM.SetTab(0)
	Gui.frmCRM.txtDays.Text("90")

	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.CallSub(LoadDdl)
	F.Intrinsic.Control.CallSub(LoadComboBoxes)
	F.Intrinsic.Control.CallSub(CheckDefault)
	F.Intrinsic.Control.CallSub(SelectOpts)
	F.Intrinsic.Control.UnBlockEvents
	Gui.frmCRM..Show
	F.Intrinsic.Control.CallSub(SetTabAnchors)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.frmCRM_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.End

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.frmCRM_UnLoad.End

Program.Sub.frmCRM_Resize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.fW.Declare
	V.Local.fWBase.Declare
	V.Local.fH.Declare
	V.Local.fHBase.Declare
	V.Local.fX.Declare
	V.Local.fY.Declare
	V.Local.fRet.Declare

'	.Size(Width,Heigth)
'	.Position(X,Y)

	F.Intrinsic.Math.Sub(V.Screen.frmCRM!tabCRM.Width,15090,V.Local.fWBase)
	F.Intrinsic.Math.Sub(V.Screen.frmCRM!tabCRM.Height,7920,V.Local.fHBase)
	F.Intrinsic.Math.Div(V.Local.fHBase,2,V.Local.fHBase)
	'GsGCOppor
	F.Intrinsic.Math.Add(14970,V.Local.fWBase,V.Local.fW)
	F.Intrinsic.Math.Add(4305,V.Local.fHBase,V.Local.fH)
	Gui.frmCRM.GsGCOppor.Size(V.Local.fW,V.Local.fH)
	'gsChartOpp1
	F.Intrinsic.Math.Add(V.Screen.frmCRM!GsGCOppor.Top,V.Screen.frmCRM!GsGCOppor.Height,50,V.Local.fY)
	Gui.frmCRM.gsChartOpp1.Position(V.Screen.frmCRM!gsChartOpp1.Left,V.Local.fY)
	F.Intrinsic.Math.Div(V.Local.fWBase,2,V.Local.fWBase)
	F.Intrinsic.Math.Add(7455,V.Local.fWBase,V.Local.fW)
	F.Intrinsic.Math.Add(3165,V.Local.fHBase,V.Local.fH)
	Gui.frmCRM.gsChartOpp1.Size(V.Local.fW,V.Local.fH)
	'gsChartOpp2
	Gui.frmCRM.gsChartOpp2.Size(V.Local.fW,V.Local.fH)
	F.Intrinsic.Math.Add(V.Screen.frmCRM!gsChartOpp1.Left,V.Screen.frmCRM!gsChartOpp1.Width,50,V.Local.fx)
	Gui.frmCRM.gsChartOpp2.Position(V.Local.fX,V.Local.fY)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.frmCRM_Resize.End

Program.Sub.CheckTable.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.bExists.Declare

	F.ODBC.Connection!con.OpenCompanyConnection(300)

	F.ODBC.Connection!con.TableExists("GAB_6572_NOTES",V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists,=,False)
		F.ODBC.Connection!con.Execute("CREATE TABLE GAB_6572_NOTES(NID IDENTITY,SALESPERSON CHAR(3),CUSTOMER CHAR(6),PART CHAR(20),LOC CHAR(2),GSUSER CHAR(8),CREATE_DT DATE,CREATE_TIME TIME,NOTES LONGVARCHAR,PRIMARY KEY(NID));")
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.TableExists("GAB_6572_SECURITY",V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists,=,False)
		F.ODBC.Connection!con.Execute("CREATE TABLE GAB_6572_SECURITY(SID IDENTITY,USER_ID CHAR(8),SP_ID CHAR(3),LOCATION CHAR(2),PRIMARY KEY(SID));")
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.Close
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckTable.End

Program.Sub.CheckSecurity.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sSql.Declare
	
	F.ODBC.Connection!con.OpenCompanyConnection(300)
	
	F.Intrinsic.String.Build("Select SP_ID,LOCATION From GAB_6572_SECURITY Where User_ID = '{0}';",V.Caller.User,V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("dtSec","con",V.Local.sSql,True)
	F.Intrinsic.Control.If(V.DataTable.dtSec.RowCount,=,0)
		V.Global.bAdmin.Set(True)
	F.Intrinsic.Control.Else
		V.Global.bAdmin.Set(False)
		V.Global.sSPID.Set(V.DataTable.dtSec(0).SP_ID!FieldValTrim)
		V.Global.sLoc.Set(V.DataTable.dtSec(0).LOCATION!FieldValTrim)
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.Close

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckSecurity.End

Program.Sub.CheckLongPart.Start
	F.Global.General.ReadOption("400861",0,False,"0000",V.Global.bLongPart)
	F.Intrinsic.Control.If(V.Global.bLongPart,=,False)
		F.Global.General.ReadOption("400861",0,False,"0004",V.Global.bLongPart)
	F.Intrinsic.Control.EndIf
Program.Sub.CheckLongPart.End

Program.Sub.SetAnchors.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.iYear.Declare
	V.Local.sCaption.Declare
	V.Local.sCaptionQty.Declare
	
	'0 - None
	'1 - Top
	'2 - Bottom
	'4 - Left
	'8 - Right

	Gui.frmCRM.picGSSLogo.Anchor(1)
	Gui.frmCRM.tabCRM.Anchor(15)
'	Gui.frmCRM.GsGCSalesHist.Anchor(15)
'	Gui.frmCRM.GsGCSalesOrders.Anchor(15)
'	Gui.frmCRM.GsGCQuotes.Anchor(15)
'	Gui.frmCRM.GsGCEvents.Anchor(15)
'	Gui.frmCRM.GsGCNotes.Anchor(15)
	Gui.frmCRM.frameOpts.Anchor(5)
	Gui.frmCRM.framePermissions.Anchor(9)
	Gui.frmCRM.framePermissions1.Anchor(9)
	Gui.frmCRM.framePermissions2.Anchor(9)
	Gui.frmCRM.lblStatus.Anchor(5)
	Gui.frmCRM.pbStatus.Anchor(5)

	
	F.Intrinsic.Control.For(V.Local.iCnt,0,2,1)
		F.Intrinsic.Control.If(V.Local.iCnt,=,0)
			F.Intrinsic.Date.Year(V.Ambient.Date,V.Local.iYear)
			V.Local.sCaption.Set("YTD")
			V.Local.sCaptionQty.Set("YTD")
		F.Intrinsic.Control.Else
			F.Intrinsic.Math.Sub(V.Local.iYear,1,V.Local.iYear)
			V.Local.sCaption.Set(V.Local.iYear.String)
			V.Local.sCaptionQty.Set(V.Local.iYear.String)
		F.Intrinsic.Control.EndIf
		'Changes in 02/15/2021
		'F.Intrinsic.String.Build("{0} ({1})",V.Local.sCaption,V.Company.CurrencySymbol,V.Local.sCaption)
		'Gui.frmCRM.lblY[V.Local.iCnt]Dollars.Text(V.Local.sCaption)
		'F.Intrinsic.String.Build("{0} Qty",V.Local.sCaptionQty,V.Local.sCaptionQty)
		'Gui.frmCRM.lblY[V.Local.iCnt]Qty.Text(V.Local.sCaptionQty)
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.SetAnchors.End

Program.Sub.SetTabAnchors.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.iYear.Declare
	V.Local.sCaption.Declare
	V.Local.sCaptionQty.Declare
	
	'0 - None
	'1 - Top
	'2 - Bottom
	'4 - Left
	'8 - Right

	Gui.frmCRM.GsGCSalesHist.Anchor(15)
	Gui.frmCRM.GsGCSalesOrders.Anchor(15)
	Gui.frmCRM.GsGCQuotes.Anchor(15)
	Gui.frmCRM.GsGCEvents.Anchor(15)
	Gui.frmCRM.GsGCNotes.Anchor(15)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.SetTabAnchors.End

Program.Sub.LoadComboBoxes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.ODBC.Connection!con.OpenCompanyConnection(300)
	
	'Salespersons
	F.Data.DataTable.CreateFromSQL("dtSP","con","Select RTrim(ID) As ID,RTrim(Name) As Name From V_Salespersons Where ID <> '' Union Select '' As ID,'' As Name From V_Salespersons Order by Name;",True)
	Gui.frmCRM.cboSP.AddItems("DataTable","dtSP","ID","Name")
	Gui.frmCRM.cboSP.Text("")
	'Customers
	F.Data.DataTable.CreateFromSQL("dtCust","con","Select RTrim(Customer) As Customer,RTrim(Name_Customer) As Name_Customer From V_Customer_Master Order By Name_Customer;",True)
	Gui.frmCRM.cboCust.AddItems("DataTable","dtCust","Customer","Name_Customer")
	Gui.frmCRM.cboCust.Text("")
	'Contacts
	F.Data.DataTable.CreateFromSQL("dtContact","con","Select Alt_ID,RTrim(Name) As Name,Cust From Contact Where Name <> '' Order By Name;",True)
	Gui.frmCRM.cboContact.AddItems("DataTable","dtContact","Alt_ID","Name")
	Gui.frmCRM.cboContact.Text("")
	'Parts
	F.Data.DataTable.CreateFromSQL("dtPart","con","Select RTrim(Part) As Part From V_Inventory_Mstr Order By Part;",True)
	Gui.frmCRM.cboPart.AddItems("DataTable","dtPart","Part","Part")
	Gui.frmCRM.cboPart.Text("")
	
	F.ODBC.Connection!con.Close
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadComboBoxes.End

Program.Sub.LoadDdl.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	
	Gui.frmCRM.ddlOpts.AddItem("All Data",0)
	F.Intrinsic.Control.If(V.Global.bAdmin)
		Gui.frmCRM.ddlOpts.AddItem("Salesperson",1)
		Gui.frmCRM.ddlOpts.AddItem("Customer",2)
		Gui.frmCRM.ddlOpts.AddItem("Contact",3)
		Gui.frmCRM.ddlOpts.AddItem("Part",4)
	F.Intrinsic.Control.Else
		Gui.frmCRM.ddlOpts.AddItem("Customer",1)
		Gui.frmCRM.ddlOpts.AddItem("Contact",2)
		Gui.frmCRM.ddlOpts.AddItem("Part",3)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDdl.End

Program.Sub.SelectOpts.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmCRM.cboSP.Text("")
	Gui.frmCRM.cboSP.Enabled(False)
	Gui.frmCRM.cboSP.Visible(False)
	
	Gui.frmCRM.cboCust.Text("")
	Gui.frmCRM.cboCust.Enabled(False)
	Gui.frmCRM.cboCust.Visible(False)
	
	Gui.frmCRM.cboContact.Text("")
	Gui.frmCRM.cboContact.Enabled(False)
	Gui.frmCRM.cboContact.Visible(False)
	
	Gui.frmCRM.cboPart.Text("")
	Gui.frmCRM.cboPart.Enabled(False)
	Gui.frmCRM.cboPart.Visible(False)
	
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRM OPTION",6572,0,False,V.Screen.frmCRM!ddlOpts.Text,True,0,-999.0,1/1/1980,12:00:00 AM)
	
	F.Intrinsic.Control.SelectCase(V.Screen.frmCRM!ddlOpts.Text)
		F.Intrinsic.Control.Case("All Data")
			'None
		F.Intrinsic.Control.Case("Salesperson")
			Gui.frmCRM.cboSP.Enabled(True)
			Gui.frmCRM.cboSP.Visible(True)
			
		F.Intrinsic.Control.Case("Customer")
			Gui.frmCRM.cboCust.Enabled(True)
			Gui.frmCRM.cboCust.Visible(True)
			
		F.Intrinsic.Control.Case("Contact")
			Gui.frmCRM.cboContact.Enabled(True)
			Gui.frmCRM.cboContact.Visible(True)
			
		F.Intrinsic.Control.Case("Part")
			Gui.frmCRM.cboPart.Enabled(True)
			Gui.frmCRM.cboPart.Visible(True)
			
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.SelectOpts.End

Program.Sub.tabCRM_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.SelectCase(V.Screen.frmCRM!tabCRM.Tab)
		F.Intrinsic.Control.Case(0)
			Gui.frmCRM.framePermissions.Visible(True)
			Gui.frmCRM.framePermissions1.Visible(False)
			Gui.frmCRM.framePermissions2.Visible(False)
			Gui.frmCRM.lblDays.Visible(False)
			Gui.frmCRM.txtDays.Visible(False)
		F.Intrinsic.Control.Case(1)
			Gui.frmCRM.framePermissions.Visible(False)
			Gui.frmCRM.framePermissions1.Visible(True)
			Gui.frmCRM.framePermissions2.Visible(False)
			Gui.frmCRM.lblDays.Visible(False)
			Gui.frmCRM.txtDays.Visible(False)
		F.Intrinsic.Control.Case(2)
			Gui.frmCRM.framePermissions.Visible(False)
			Gui.frmCRM.framePermissions1.Visible(False)
			Gui.frmCRM.framePermissions2.Visible(True)
			Gui.frmCRM.lblDays.Visible(True)
			Gui.frmCRM.txtDays.Visible(True)
		F.Intrinsic.Control.CaseElse
			Gui.frmCRM.framePermissions.Visible(True)
			Gui.frmCRM.framePermissions1.Visible(False)
			Gui.frmCRM.framePermissions2.Visible(False)
			Gui.frmCRM.lblDays.Visible(False)
			Gui.frmCRM.txtDays.Visible(False)
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.tabCRM_Click.End

Program.Sub.cboSP_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSelect.Declare
	V.Local.sFilter.Declare
	
	V.Global.sFieldName.Set("Salesperson")
	F.Intrinsic.String.Build("Name = '{0}'",V.Screen.frmCRM!cboSP.Text,V.Local.sFilter)
	F.Data.DataTable.Select("dtSP",V.Local.sFilter,V.Local.sSelect)
	V.Global.sData.Set(V.DataTable.dtSP(V.Local.sSelect.Long).ID!FieldVal)
	'F.Intrinsic.Control.CallSub(LoadData)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cboSP_Click.End

Program.Sub.cboCust_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSelect.Declare
	V.Local.sFilter.Declare
	V.Local.sCustomer.Declare
	
	V.Global.sFieldName.Set("Customer")
	V.Local.sCustomer.Set(V.Screen.frmCRM!cboCust.Text)
	F.Intrinsic.String.Replace(V.Local.sCustomer,"'","''",V.Local.sCustomer)
	F.Intrinsic.String.Build("Name_Customer = '{0}'",V.Local.sCustomer,V.Local.sFilter)
	F.Data.DataTable.Select("dtCust",V.Local.sFilter,V.Local.sSelect)
	V.Global.sData.Set(V.DataTable.dtCust(V.Local.sSelect.Long).Customer!FieldVal)
	F.Intrinsic.String.Build("'{0}'",V.DataTable.dtCust(V.Local.sSelect.Long).Customer!FieldVal,V.Global.sCustomers)
	'F.Intrinsic.Control.CallSub(LoadData)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cboCust_Click.End

Program.Sub.cboContact_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSelect.Declare
	V.Local.sFilter.Declare
	V.Local.sContact.Declare
	
	V.Global.sFieldName.Set("Customer")
	V.Local.sContact.Set(V.Screen.frmCRM!cboContact.Text)
	F.Intrinsic.String.Replace(V.Local.sContact,"'","''",V.Local.sContact)
	F.Intrinsic.String.Build("Name = '{0}'",V.Local.sContact,V.Local.sFilter)
	F.Data.DataTable.Select("dtContact",V.Local.sFilter,V.Local.sSelect)
	V.Global.sData.Set(V.DataTable.dtContact(V.Local.sSelect.Long).Cust!FieldVal)
	F.Intrinsic.String.Build("'{0}'",V.DataTable.dtContact(V.Local.sSelect.Long).Cust!FieldVal,V.Global.sCustomers)
	'F.Intrinsic.Control.CallSub(LoadData)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cboContact_Click.End

Program.Sub.cboPart_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Global.sFieldName.Set("Part")
	V.Global.sData.Set(V.Screen.frmCRM!cboPart.Text)
	'F.Intrinsic.Control.CallSub(LoadData)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cboPart_Click.End

Program.Sub.LoadData.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	V.Local.sSelect.Declare
	V.Local.sFilter.Declare
	V.Local.sCustomer.Declare
	V.Local.sContact.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.SelectCase(V.Screen.frmCRM!ddlOpts.Text)
		F.Intrinsic.Control.Case("All Data")
			'None
		F.Intrinsic.Control.Case("Salesperson")
			V.Global.sFieldName.Set("Salesperson")
			F.Intrinsic.String.Build("Name = '{0}'",V.Screen.frmCRM!cboSP.Text,V.Local.sFilter)
			F.Data.DataTable.Select("dtSP",V.Local.sFilter,V.Local.sSelect)
			V.Global.sData.Set(V.DataTable.dtSP(V.Local.sSelect.Long).ID!FieldVal)
			
		F.Intrinsic.Control.Case("Customer")
			V.Global.sFieldName.Set("Customer")
			V.Local.sCustomer.Set(V.Screen.frmCRM!cboCust.Text)
			F.Intrinsic.String.Replace(V.Local.sCustomer,"'","''",V.Local.sCustomer)
			F.Intrinsic.String.Build("Name_Customer = '{0}'",V.Local.sCustomer,V.Local.sFilter)
			F.Data.DataTable.Select("dtCust",V.Local.sFilter,V.Local.sSelect)
			V.Global.sData.Set(V.DataTable.dtCust(V.Local.sSelect.Long).Customer!FieldVal)
			F.Intrinsic.String.Build("'{0}'",V.DataTable.dtCust(V.Local.sSelect.Long).Customer!FieldVal,V.Global.sCustomers)

			
		F.Intrinsic.Control.Case("Contact")
			V.Global.sFieldName.Set("Customer")
			V.Local.sContact.Set(V.Screen.frmCRM!cboContact.Text)
			F.Intrinsic.String.Replace(V.Local.sContact,"'","''",V.Local.sContact)
			F.Intrinsic.String.Build("Name = '{0}'",V.Local.sContact,V.Local.sFilter)
			F.Data.DataTable.Select("dtContact",V.Local.sFilter,V.Local.sSelect)
			V.Global.sData.Set(V.DataTable.dtContact(V.Local.sSelect.Long).Cust!FieldVal)
			F.Intrinsic.String.Build("'{0}'",V.DataTable.dtContact(V.Local.sSelect.Long).Cust!FieldVal,V.Global.sCustomers)
			
		F.Intrinsic.Control.Case("Part")
				V.Global.sFieldName.Set("Part")
				V.Global.sData.Set(V.Screen.frmCRM!cboPart.Text)
				
	F.Intrinsic.Control.EndSelect
	
	Gui.frmCRM.lblStatus.Caption("Loading....")
	Gui.frmCRM.lblStatus.Visible(True)
	Gui.frmCRM.pbStatus.Visible(True)
	Gui.frmCRM.pbStatus.Min(0)
	Gui.frmCRM.pbStatus.Max(100)
	Gui.frmCRM.pbStatus.Value(5)
	
	Gui.frmCRM.lblStatus.Caption("Loading Sales History....")
	F.Intrinsic.Control.CallSub(LoadSalesHistory)
	Gui.frmCRM.pbStatus.Value(10)
	Gui.frmCRM.lblStatus.Caption("Loading Sales Orders....")
	F.Intrinsic.Control.CallSub(LoadSalesOrders)
	Gui.frmCRM.pbStatus.Value(25)
	Gui.frmCRM.lblStatus.Caption("Loading Quotes....")
	F.Intrinsic.Control.CallSub(LoadQuotes)
	Gui.frmCRM.pbStatus.Value(35)
	Gui.frmCRM.lblStatus.Caption("Retrieving Customer Informaiton....")
	F.Intrinsic.Control.CallSub(GetDistinctCustomers)
	Gui.frmCRM.pbStatus.Value(45)
	Gui.frmCRM.lblStatus.Caption("Loading Customer Information....")
	F.Intrinsic.Control.CallSub(LoadAddlCustInfo)
	Gui.frmCRM.pbStatus.Value(55)
	Gui.frmCRM.lblStatus.Caption("Loading CRM Opportunities....")
	F.Intrinsic.Control.CallSub(LoadOppor)
	Gui.frmCRM.pbStatus.Value(65)
	Gui.frmCRM.lblStatus.Caption("Loading CRM Events....")
	F.Intrinsic.Control.CallSub(LoadEvents)
	Gui.frmCRM.pbStatus.Value(75)
	Gui.frmCRM.lblStatus.Caption("Loading CRM Notes....")
	F.Intrinsic.Control.CallSub(LoadNotes)
	Gui.frmCRM.pbStatus.Value(85)
	V.Global.bLoadData.Set(True)
	
	Gui.frmCRM.pbStatus.Value(95)
	F.Intrinsic.Control.CallSub(Deserialize)
	
	Gui.frmCRM.pbStatus.Value(100)
	Gui.frmCRM.lblStatus.Visible(False)
	Gui.frmCRM.pbStatus.Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadData.End

Program.Sub.GetDistinctCustomers.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.sCustomers.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtSalesHistCust.Exists)
		F.Data.DataTable.Close("dtSalesHistCust")
		F.Data.DataTable.Close("dtSalesOrdersCust")
		F.Data.DataTable.Close("dtQuotesCust")
		F.Data.DataTable.Close("dtDistinctCust")
	F.Intrinsic.Control.EndIf
	
	'Distinct Customers from Sales History
	F.Data.DataView.Create("dtSalesHist","dvSalesHist")
	F.Data.DataView.ToDataTableDistinct("dtSalesHist","dvSalesHist","dtSalesHistCust","Customer",True)
	F.Data.DataView.Close("dtSalesHist","dvSalesHist")
	'Distinct Customers from Sales Orders
	F.Data.DataView.Create("dtSalesOrders","dvSalesOrdersCust")
	F.Data.DataView.ToDataTableDistinct("dtSalesOrders","dvSalesOrdersCust","dtSalesOrdersCust","Customer",True)
	F.Data.DataView.Close("dtSalesOrders","dvSalesOrdersCust")
	'Distinct Customers from Quotes
	F.Data.DataView.Create("dtQuotes","dvQuotesCust")
	F.Data.DataView.ToDataTableDistinct("dtQuotes","dvQuotesCust","dtQuotesCust","Customer",True)
	F.Data.DataView.Close("dtQuotes","dvQuotesCust")
	'Megre Distinct Customers Above
	F.Data.DataTable.Merge("dtSalesOrdersCust","dtSalesHistCust",True,3)
	F.Data.DataTable.Merge("dtQuotesCust","dtSalesHistCust",True,3)
	'Distinct Customers from Merge
	F.Data.DataView.Create("dtSalesHistCust","dvSalesHistCust")
	F.Data.DataView.ToDataTableDistinct("dtSalesHistCust","dvSalesHistCust","dtDistinctCust","Customer",True)
	
	'Create string for query
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtDistinctCust.RowCount--,1)
		F.Intrinsic.String.Replace(V.DataTable.dtDistinctCust(V.Local.iCnt).Customer!FieldValTrim,"'","''",V.Local.sCustomers)
		F.Intrinsic.Control.If(V.Local.iCnt,=,0)
			F.Intrinsic.String.Build("'{0}'",V.Local.sCustomers,V.Global.sCustomers.Trim)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0},'{1}'",V.Global.sCustomers,V.Local.sCustomers,V.Global.sCustomers)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GetDistinctCustomers.End

Program.Sub.LoadAddlCustInfo.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare

	F.ODBC.Connection!con.OpenCompanyConnection(300)

'	F.Intrinsic.String.Build("Select Customer,RTrim(Name_Customer) As Name_Customer,RTrim(Name_Prefix+Name) As Primary_Contact,RTrim(Case When Length(LTrim(Phone1)) = 10 Then Left(LTrim(Phone1),3)+'-'+SubString(LTrim(Phone1),4,3)+'-'+Right(LTrim(Phone1),4) Else LTrim(Phone1) End) As Primary_Phone,RTrim(Email1) As Primary_Email,RTrim(Address1) As Address1,RTrim(Address2) As Address2,RTrim(City) As City,RTrim(State) As State,RTrim(Zip) As Zip,RTrim(Country) As Country,RTrim(Case When Length(LTrim(Telephone)) = 10 Then Left(LTrim(Telephone),3)+'-'+SubString(LTrim(Telephone),4,3)+'-'+Right(LTrim(Telephone),4) Else LTrim(Telephone) End) As Telephone From V_Customer_Master A Left Join V_Contact B On A.Customer = B.Cust And Pri_Cntct = 1 And Customer In ({0}) Order By Name_Customer;",V.Global.sCustomers,V.Local.sSQL)
	F.Intrinsic.String.Build("Select A.Customer,RTrim(A.Name_Customer) As Name_Customer,RTrim(B.Name_Prefix+B.Name) As Primary_Contact,RTrim(Case When Length(LTrim(B.Phone1)) = 10 Then Left(LTrim(B.Phone1),3)+'-'+SubString(LTrim(B.Phone1),4,3)+'-'+Right(LTrim(B.Phone1),4) Else LTrim(B.Phone1) End) As Primary_Phone,RTrim(B.Email1) As Primary_Email,RTrim(Case When Length(LTrim(A.Telephone)) = 10 Then Left(LTrim(A.Telephone),3)+'-'+SubString(LTrim(A.Telephone),4,3)+'-'+Right(LTrim(A.Telephone),4) Else LTrim(A.Telephone) End) As Telephone From V_Customer_Master A Left Join V_Contact B On A.Customer = B.Cust And Pri_Cntct = 1 And A.Customer In ({0}) Order By Name_Customer;",V.Global.sCustomers,V.Local.sSQL)
	F.Data.DataTable.CreateFromSQL("dtSalesHist0$dtCustInfo","con",V.Local.sSQL,True)
	F.Data.DataView.Create("dtSalesHist0$dtCustInfo","dvCustInfo")
	F.Data.DataTable.AddRelation("dtSalesHist0","Customer","dtSalesHist0$dtCustInfo","Customer")
	F.Intrinsic.Control.CallSub(LoadGvAddlCustInfo)
	F.ODBC.Connection!con.Close
	
	F.Intrinsic.Control.CatchWhen(21034)
		F.Intrinsic.Control.CallSub(LoadGvAddlCustInfo)
		F.ODBC.Connection!con.Close
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadAddlCustInfo.End

Program.Sub.LoadGvAddlCustInfo.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmCRM.GsGCSalesHist.AddGridviewFromDataview("gvCustInfo","dtSalesHist0","dvCustInfo")
	Gui.frmCRM.GsGCSalesHist.SetGridViewProperty("gvCustInfo","MultiSelect",True)
	Gui.frmCRM.GsGCSalesHist.SetGridViewProperty("gvCustInfo","AllowSort",True)
	Gui.frmCRM.GsGCSalesHist.SetGridViewProperty("gvCustInfo","AllowFilter",True)
	Gui.frmCRM.GsGCSalesHist.SetGridViewProperty("gvCustInfo","Editable",True)
	Gui.frmCRM.GsGCSalesHist.SetGridViewProperty("gvCustInfo","ReadOnly",True)
	Gui.frmCRM.GsGCSalesHist.SetGridViewProperty("gvCustInfo","ShowGroupPanel",False)
	
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Customer","Visible",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Name_Customer","Visible",False)
	
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Customer","Caption","Customer")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Name_Customer","Caption","Customer Name")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Contact","Caption","Primary Contact")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Phone","Caption","Primary Phone")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Email","Caption","Primary Email")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Address1","Caption","Address 1")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Address2","Caption","Address 2")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","City","Caption","City")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","State","Caption","State")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Zip","Caption","Zip")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Country","Caption","Country")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Telephone","Caption","Main Phone")
	
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Customer","MinWidth","65")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Name_Customer","MinWidth","120")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Contact","MinWidth","120")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Phone","MinWidth","85")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Email","MinWidth","100")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Address1","MinWidth","150")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Address2","MinWidth","100")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","City","MinWidth","100")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","State","MinWidth","50")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Zip","MinWidth","65")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Country","MinWidth","65")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Telephone","MinWidth","85")
	
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Customer","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Name_Customer","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Contact","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Phone","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Email","HeaderHAlignment","Center")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Address1","HeaderHAlignment","Center")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Address2","HeaderHAlignment","Center")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","City","HeaderHAlignment","Center")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","State","HeaderHAlignment","Center")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Zip","HeaderHAlignment","Center")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Country","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Telephone","HeaderHAlignment","Center")

	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Customer","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Name_Customer","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Contact","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Phone","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Email","HeaderFontBold",True)
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Address1","HeaderFontBold",True)
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Address2","HeaderFontBold",True)
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","City","HeaderFontBold",True)
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","State","HeaderFontBold",True)
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Zip","HeaderFontBold",True)
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Country","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Telephone","HeaderFontBold",True)
	
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Customer","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Contact","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Phone","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Primary_Email","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Name_Customer","CellHAlignment","Center")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Address1","CellHAlignment","Center")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Address2","CellHAlignment","Center")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","City","CellHAlignment","Center")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","State","CellHAlignment","Center")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Zip","CellHAlignment","Center")
'	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Country","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvCustInfo","Telephone","CellHAlignment","Center")

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGvAddlCustInfo.End

Program.Sub.LoadSalesHistory.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtSalesHist.Exists)
		F.Data.DataTable.Close("dtSalesHist0")
		F.Data.DataTable.Close("dtSalesHist")
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.OpenCompanyConnection(300)
	
	F.Intrinsic.Control.SelectCase(V.Screen.frmCRM!ddlOpts.Text)
		F.Intrinsic.Control.Case("All Data")
			F.Data.DataTable.CreateFromSQL("dtSalesHist","con","Select A.Salesperson,RTrim(A.Salesperson) As Salesperson2,A.Customer,RTrim(A.Name_Cust_Ship) As Name_Cust_Ship,A.Customer_Ship,RTrim(A.Address1_Ship) As Address1_Ship,RTrim(A.Address2_Ship) As Address2_Ship,RTrim(A.Address3_Ship) As Address3_Ship,RTrim(A.Address4_Ship) As Address4_Ship,RTrim(A.Address5_Ship) As Address5_Ship,RTrim(A.City_Ship) As City_Ship,RTrim(A.State_Ship) As State_Ship,RTrim(A.Zip_Ship) As Zip_Ship,RTrim(A.Country_Ship) As Country_Ship,A.Part,'' As Display_Part,A.Location,A.Description, B.DESCRIPTION AS INV_DESC, RTRIM(LTRIM(B.DESCRIPTION_2)) AS ALT_DESC, B.CODE_SORT, A.Product_Line,A.Extension,A.Extension_Order,A.Qty_Shipped,Year(A.Date_Invoice) As Date_Invoice_Year,A.Customer+A.Customer_Ship As CustShipTo From V_Order_Hist_Line A LEFT JOIN V_INVENTORY_ALL B ON A.PART = B.PART AND A.LOCATION = B.LOCATION Where Year(A.Date_Invoice) Between Year(DateAdd(Year,-2,CurDate())) And Year(CurDate());",True)
		F.Intrinsic.Control.CaseAny("Salesperson","Customer","Contact","Part")
			F.Intrinsic.String.Build("Select A.Salesperson,RTrim(A.Salesperson) As Salesperson2,A.Customer,RTrim(A.Name_Cust_Ship) As Name_Cust_Ship,A.Customer_Ship,RTrim(A.Address1_Ship) As Address1_Ship,RTrim(A.Address2_Ship) As Address2_Ship,RTrim(A.Address3_Ship) As Address3_Ship,RTrim(A.Address4_Ship) As Address4_Ship,RTrim(A.Address5_Ship) As Address5_Ship,RTrim(A.City_Ship) As City_Ship,RTrim(A.State_Ship) As State_Ship,RTrim(A.Zip_Ship) As Zip_Ship,RTrim(A.Country_Ship) As Country_Ship,A.Part,'' As Display_Part,A.Location,A.Description, B.DESCRIPTION AS INV_DESC RTRIM(LTRIM(B.DESCRIPTION_2)) AS ALT_DESC, B.CODE_SORT, A.Product_Line,A.Extension,A.Extension_Order,A.Qty_Shipped,Year(A.Date_Invoice) As Date_Invoice_Year,A.Customer+A.Customer_Ship As CustShipTo From V_Order_Hist_Line A LEFT JOIN V_INVENTORY_ALL B ON A.PART = B.PART AND A.LOCATION = B.LOCATION Where Year(Date_Invoice) Between Year(DateAdd(Year,-2,CurDate())) And Year(CurDate()) And {0} = '{1}';",V.Global.sFieldName,V.Global.sData,V.Local.sSQL)
			F.Data.DataTable.CreateFromSQL("dtSalesHist","con",V.Local.sSQL,True)
	F.Intrinsic.Control.EndSelect
	
	F.Data.DataTable.AddDisplayPartColumn("dtSalesHist",0,"Part","Display_Part")
	
	F.Intrinsic.Control.CallSub(LoadSalesHistory2)
	'Filter Security
	F.Intrinsic.Control.If(V.Global.bAdmin,=,False)
		F.Intrinsic.Control.CallSub(LoadSalesHistoryApplySec)
	F.Intrinsic.Control.Else
		F.Data.DataView.Create("dtSalesHist2","dvSalesHist2")
		F.Data.DataView.ToDataTable("dtSalesHist2","dvSalesHist2","dtSalesHist0",True)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(LoadGvSalesHistory)
	
	F.ODBC.Connection!con.Close
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadSalesHistory.End

Program.Sub.LoadSalesHistory2.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iYear.Declare
	V.Local.iCnt.Declare
	V.Local.iCnt2.Declare
	V.Local.sFilter.Declare
	V.Local.fDollars.Declare
	V.Local.fQty.Declare
	V.Local.sColumnDollars.Declare
	V.Local.sColumnQty.Declare
	V.Local.sSalesperson.Declare
	V.Local.sCustomer.Declare
	V.Local.sCustShipTo.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtSalesHist2.Exists)
		F.Data.DataTable.Close("dtSalesHist2")
		F.Data.Dictionary.Close("dSPName")
		F.Data.Dictionary.Close("dPL")
		F.Data.Dictionary.Close("dQtyOnHand")
		F.Data.Dictionary.Close("dNote")
		F.Data.Dictionary.Close("dAdd1")
		F.Data.Dictionary.Close("dAdd2")
		F.Data.Dictionary.Close("dAdd3")
		F.Data.Dictionary.Close("dAdd4")
		F.Data.Dictionary.Close("dAdd5")
		F.Data.Dictionary.Close("dCity")
		F.Data.Dictionary.Close("dState")
		F.Data.Dictionary.Close("dZip")
		F.Data.Dictionary.Close("dCountry")
	F.Intrinsic.Control.EndIf
	
	F.Data.DataView.Create("dtSalesHist","dvSalesHist2")
	F.Data.DataView.ToDataTableDistinct("dtSalesHist","dvSalesHist2","dtSalesHist2","Salesperson*!*Salesperson2*!*Customer*!*Name_Cust_Ship*!*Customer_Ship*!*Part*!*Display_Part*!*Location*!*CustShipTo*!*INV_DESC*!*ALT_DESC*!*CODE_SORT",True)
	F.Data.DataTable.AddExpressionColumn("dtSalesHist2","SpCustPt",String,"Salesperson+Customer+Part")
	F.Data.DataTable.AddColumn("dtSalesHist2","Product_Line",String)
	F.Data.DataTable.AddColumn("dtSalesHist2","Y0_Dollars",Float)
	F.Data.DataTable.AddColumn("dtSalesHist2","Y1_Dollars",Float)
	F.Data.DataTable.AddColumn("dtSalesHist2","Y2_Dollars",Float)
	F.Data.DataTable.AddColumn("dtSalesHist2","Y0_Qty",Float)
	F.Data.DataTable.AddColumn("dtSalesHist2","Y1_Qty",Float)
	F.Data.DataTable.AddColumn("dtSalesHist2","Y2_Qty",Float)
	F.Data.DataTable.AddColumn("dtSalesHist2","Qty_OnHand",Float)
	F.Data.DataTable.AddColumn("dtSalesHist2","Last_Note",String)
	F.Data.DataTable.AddColumn("dtSalesHist2","Notes",String,"Notes")
	F.Data.DataTable.AddColumn("dtSalesHist2","Address1_Ship",String)
	F.Data.DataTable.AddColumn("dtSalesHist2","Address2_Ship",String)
	F.Data.DataTable.AddColumn("dtSalesHist2","Address3_Ship",String)
	F.Data.DataTable.AddColumn("dtSalesHist2","Address4_Ship",String)
	F.Data.DataTable.AddColumn("dtSalesHist2","Address5_Ship",String)
	F.Data.DataTable.AddColumn("dtSalesHist2","City_Ship",String)
	F.Data.DataTable.AddColumn("dtSalesHist2","State_Ship",String)
	F.Data.DataTable.AddColumn("dtSalesHist2","Zip_Ship",String)
	F.Data.DataTable.AddColumn("dtSalesHist2","Country_Ship",String)

	'Fill Salesperson Name
	F.Data.Dictionary.CreateFromDataTable("dSPName","dtSP","ID","Name")
	F.Data.Dictionary.SetDefaultReturn("dSPName","")
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dSPName","Salesperson2")
	'Fill Product Line
	F.Data.Dictionary.CreateFromSQL("dPL","con","Select Part,Product_Line From V_Inventory_Mstr;")
	F.Data.Dictionary.SetDefaultReturn("dPL","")
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dPL","Part","Product_Line")
	'Fill Qty_OnHand
	F.Data.Dictionary.CreateFromSQL("dQtyOnHand","con","Select Part,Qty_OnHand From V_Inventory_Mstr;")
	F.Data.Dictionary.SetDefaultReturn("dQtyOnHand",0)
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dQtyOnHand","Part","Qty_OnHand")
	'Fill Notes
	F.Data.Dictionary.CreateFromSQL("dNote","con","Select Salesperson+Customer+Part As SpCustPt,Notes From Gab_6572_Notes;")
	F.Data.Dictionary.SetDefaultReturn("dNote","")
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dNote","SpCustPt","Last_Note")
	'Fill Address1_Ship
	F.Data.Dictionary.CreateFromDataTable("dAdd1","dtSalesHist","CustShipTo","Address1_Ship")
	F.Data.Dictionary.SetDefaultReturn("dAdd1","")
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dAdd1","CustShipTo","Address1_Ship")
	'Fill Address2_Ship
	F.Data.Dictionary.CreateFromDataTable("dAdd2","dtSalesHist","CustShipTo","Address2_Ship")
	F.Data.Dictionary.SetDefaultReturn("dAdd2","")
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dAdd2","CustShipTo","Address2_Ship")
	'Fill Address3_Ship
	F.Data.Dictionary.CreateFromDataTable("dAdd3","dtSalesHist","CustShipTo","Address3_Ship")
	F.Data.Dictionary.SetDefaultReturn("dAdd3","")
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dAdd3","CustShipTo","Address3_Ship")
	'Fill Address4_Ship
	F.Data.Dictionary.CreateFromDataTable("dAdd4","dtSalesHist","CustShipTo","Address4_Ship")
	F.Data.Dictionary.SetDefaultReturn("dAdd4","")
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dAdd4","CustShipTo","Address4_Ship")
	'Fill Address5_Ship
	F.Data.Dictionary.CreateFromDataTable("dAdd5","dtSalesHist","CustShipTo","Address5_Ship")
	F.Data.Dictionary.SetDefaultReturn("dAdd5","")
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dAdd5","CustShipTo","Address5_Ship")
	'Fill City_Ship
	F.Data.Dictionary.CreateFromDataTable("dCity","dtSalesHist","CustShipTo","City_Ship")
	F.Data.Dictionary.SetDefaultReturn("dCity","")
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dCity","CustShipTo","City_Ship")
	'Fill State_Ship
	F.Data.Dictionary.CreateFromDataTable("dState","dtSalesHist","CustShipTo","State_Ship")
	F.Data.Dictionary.SetDefaultReturn("dState","")
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dState","CustShipTo","State_Ship")
	'Fill Zip_Ship
	F.Data.Dictionary.CreateFromDataTable("dZip","dtSalesHist","CustShipTo","Zip_Ship")
	F.Data.Dictionary.SetDefaultReturn("dZip","")
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dZip","CustShipTo","Zip_Ship")
	'Fill Country_Ship
	F.Data.Dictionary.CreateFromDataTable("dCountry","dtSalesHist","CustShipTo","Country_Ship")
	F.Data.Dictionary.SetDefaultReturn("dCountry","")
	F.Data.DataTable.FillFromDictionary("dtSalesHist2","dCountry","CustShipTo","Country_Ship")
	
	'Compute Dollars And Qtys
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtSalesHist2.RowCount--,1)
		F.Intrinsic.Date.Year(V.Ambient.Date,V.Local.iYear)
		F.Intrinsic.Control.For(V.Local.iCnt2,0,2,1)
			F.Intrinsic.Control.If(V.Local.iCnt2,<>,0)
				F.Intrinsic.Math.Sub(V.Local.iYear,1,V.Local.iYear)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.String.Replace(V.DataTable.dtSalesHist2(V.Local.iCnt).Salesperson!FieldValTrim,"'","''",V.Local.sSalesperson)
			F.Intrinsic.String.Replace(V.DataTable.dtSalesHist2(V.Local.iCnt).Customer!FieldValTrim,"'","''",V.Local.sCustomer)
			F.Intrinsic.String.Replace(V.DataTable.dtSalesHist2(V.Local.iCnt).Customer_Ship!FieldValTrim,"'","''",V.Local.sCustShipTo)
			F.Intrinsic.String.Replace(V.DataTable.dtSalesHist2(V.Local.iCnt).Part!FieldValTrim,"'","''",V.Local.sPart)
			F.Intrinsic.String.Replace(V.DataTable.dtSalesHist2(V.Local.iCnt).Location!FieldValTrim,"'","''",V.Local.sLoc)
			F.Intrinsic.String.Build("Date_Invoice_Year = {0} And Salesperson = '{1}' And Customer = '{2}' And Customer_Ship = '{3}' And Part = '{4}' And Location = '{5}'",V.Local.iYear,V.Local.sSalesperson,V.Local.sCustomer,V.Local.sCustShipTo,V.Local.sPart,V.Local.sLoc,V.Local.sFilter)
			F.Data.DataTable.Compute("dtSalesHist","Sum(Extension_Order)",V.Local.sFilter,V.Local.fDollars)
			F.Data.DataTable.Compute("dtSalesHist","Sum(Qty_Shipped)",V.Local.sFilter,V.Local.fQty)
			F.Intrinsic.String.Build("Y{0}_Dollars",V.Local.iCnt2,V.Local.sColumnDollars)
			F.Intrinsic.String.Build("Y{0}_Qty",V.Local.iCnt2,V.Local.sColumnQty)
			F.Data.DataTable.SetValue("dtSalesHist2",V.Local.iCnt,V.Local.sColumnDollars,V.Local.fDollars,V.Local.sColumnQty,V.Local.fQty)
		F.Intrinsic.Control.Next(V.Local.iCnt2)
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadSalesHistory2.End

Program.Sub.LoadSalesHistoryApplySec.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFilter.Declare
	
	F.Intrinsic.Control.If(V.Global.sLoc,=,"")
	F.Intrinsic.Control.AndIf(V.Global.sSPID,<>,"")
		F.Intrinsic.String.Build("Salesperson = '{0}'",V.Global.sSPID,V.Local.sFilter)
	F.Intrinsic.Control.ElseIf(V.Global.sLoc,<>,"")
	F.Intrinsic.Control.AndIf(V.Global.sSPID,=,"")
		F.Intrinsic.String.Build("Location = '{0}'",V.Global.sLoc,V.Local.sFilter)
	F.Intrinsic.Control.ElseIf(V.Global.sLoc,<>,"")
	F.Intrinsic.Control.AndIf(V.Global.sSPID,<>,"")
		F.Intrinsic.String.Build("Salesperson = '{0}' AND Location = '{1}'",V.Global.sSPID,V.Global.sLoc,V.Local.sFilter)
	F.Intrinsic.Control.ElseIf(V.Global.sLoc,=,"")
	F.Intrinsic.Control.AndIf(V.Global.sSPID,=,"")
		F.Intrinsic.UI.Msgbox(V.Translation.653901,V.Translation.429400)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndIf
	
	F.Data.DataView.Create("dtSalesHist2","dvSalesHist2",22,V.Local.sFilter,"")
	F.Data.DataView.ToDataTable("dtSalesHist2","dvSalesHist2","dtSalesHist0",True)=
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadSalesHistoryApplySec.End

Program.Sub.LoadGvSalesHistory.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.sColumn.Declare
	V.Local.sCaption.Declare
	V.Local.iYear.Declare
	
	Gui.frmCRM.GsGCSalesHist.AddGridViewFromDataTable("gvSalesHist","dtSalesHist0")
	Gui.frmCRM.GsGCSalesHist.SuspendLayout()
	Gui.frmCRM.GsGCSalesHist.SetGridViewProperty("gvSalesHist","MultiSelect",True)
	Gui.frmCRM.GsGCSalesHist.SetGridViewProperty("gvSalesHist","AllowSort",True)
	Gui.frmCRM.GsGCSalesHist.SetGridViewProperty("gvSalesHist","AllowFilter",True)
	Gui.frmCRM.GsGCSalesHist.SetGridViewProperty("gvSalesHist","Editable",False)
	Gui.frmCRM.GsGCSalesHist.SetGridViewProperty("gvSalesHist","ShowGroupPanel",True)
	Gui.frmCRM.GsGCSalesHist.SetGridViewProperty("gvSalesHist","EnableAppearanceOddRow",True)
	
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson","Visible",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer","Visible",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","SpCustPt","Visible",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","CustShipTo","Visible",False)
	
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Notes","ShowCaption",False)

	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson","Caption","Initials")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson2","Caption","Salesperson")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer","Caption","Customer")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Name_Cust_Ship","Caption","Customer Name")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer_Ship","Caption","Ship To")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","DISPLAY_PART","Caption","Part Number")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Location","Caption","Loc")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Product_Line","Caption","PL")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","INV_DESC","Caption","Description")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","ALT_DESC","Caption","Alt Desc 1")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist",	"CODE_SORT","Caption","Sort Code")
	
	'Dollars
	F.Intrinsic.Control.For(V.Local.iCnt,0,2,1)
		F.Intrinsic.Control.If(V.Local.iCnt,=,0)
			F.Intrinsic.Date.Year(V.Ambient.Date,V.Local.iYear)
			V.Local.sCaption.Set("YTD")
		F.Intrinsic.Control.Else
			F.Intrinsic.Math.Sub(V.Local.iYear,1,V.Local.iYear)
			V.Local.sCaption.Set(V.Local.iYear.String)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Build("Y{0}_Dollars",V.Local.iCnt,V.Local.sColumn)
		F.Intrinsic.String.Build("{0} ({1})",V.Local.sCaption,V.Company.CurrencySymbol,V.Local.sCaption)
		Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist",V.Local.sColumn,"Caption",V.Local.sCaption)
	F.Intrinsic.Control.Next(V.Local.iCnt)
	'Qtys
	F.Intrinsic.Control.For(V.Local.iCnt,0,2,1)
		F.Intrinsic.Control.If(V.Local.iCnt,=,0)
			F.Intrinsic.Date.Year(V.Ambient.Date,V.Local.iYear)
			V.Local.sCaption.Set("YTD Qty")
		F.Intrinsic.Control.Else
			F.Intrinsic.Math.Sub(V.Local.iYear,1,V.Local.iYear)
			F.Intrinsic.String.Build("{0} Qty",V.Local.iYear,V.Local.sCaption)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Build("Y{0}_Qty",V.Local.iCnt,V.Local.sColumn)
		Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist",V.Local.sColumn,"Caption",V.Local.sCaption)
	F.Intrinsic.Control.Next(V.Local.iCnt)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Qty_OnHand","Caption","Qty On Hand")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Last_Note","Caption","Last Note")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Notes","Caption","Notes")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address1_Ship","Caption","Address 1")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address2_Ship","Caption","Address 2")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address3_Ship","Caption","Address 3")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address4_Ship","Caption","Address 4")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address5_Ship","Caption","Address 5")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","City_Ship","Caption","City")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","State_Ship","Caption","State")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Zip_Ship","Caption","Zip")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Country_Ship","Caption","Country")

	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Name_Cust_Ship","CellForeColor","Blue")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Notes","CellForeColor","White")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Notes","CellBackColor","Gray")
	
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Part","Visible",False)
	
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson2","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Name_Cust_Ship","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer_Ship","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","DISPLAY_PART","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Location","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Product_Line","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","INV_DESC","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Alt_Desc","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","CODE_SORT","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y0_Dollars","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y1_Dollars","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y2_Dollars","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y0_Qty","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y1_Qty","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y2_Qty","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Qty_OnHand","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Last_Note","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Notes","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address1_Ship","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address2_Ship","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address3_Ship","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address4_Ship","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address5_Ship","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","City_Ship","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","State_Ship","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Zip_Ship","AllowEdit",False)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Country_Ship","AllowEdit",False)

	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson","MinWidth","50")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson2","MinWidth","115")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer","MinWidth","50")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Name_Cust_Ship","MinWidth","175")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer_Ship","MinWidth","95")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","DISPLAY_PART","MinWidth","120")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Location","MinWidth","30")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Product_Line","MinWidth","30")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","INV_DESC","MinWidth","200")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Alt_Desc","MinWidth","150")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","CODE_SORT","MinWidth","75")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y0_Dollars","MinWidth","75")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y1_Dollars","MinWidth","75")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y2_Dollars","MinWidth","75")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y0_Qty","MinWidth","75")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y1_Qty","MinWidth","75")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y2_Qty","MinWidth","75")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Qty_OnHand","MinWidth","85")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Last_Note","MinWidth","175")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Notes","MinWidth","65")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address1_Ship","MinWidth","175")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address2_Ship","MinWidth","175")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address3_Ship","MinWidth","175")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address4_Ship","MinWidth","175")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address5_Ship","MinWidth","175")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","City_Ship","MinWidth","80")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","State_Ship","MinWidth","80")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Zip_Ship","MinWidth","80")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Country_Ship","MinWidth","80")
	
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson2","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer_Ship","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Name_Cust_Ship","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","DISPLAY_PART","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Location","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Product_Line","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","INV_DESC","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Alt_Desc","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","CODE_SORT","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y0_Dollars","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y1_Dollars","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y2_Dollars","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y0_Qty","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y1_Qty","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y2_Qty","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Qty_OnHand","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Last_Note","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Notes","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address1_Ship","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address2_Ship","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address3_Ship","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address4_Ship","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address5_Ship","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","City_Ship","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","State_Ship","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Zip_Ship","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Country_Ship","HeaderFontBold",True)

	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson2","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer_Ship","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Name_Cust_Ship","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","DISPLAY_PART","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Location","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Product_Line","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","INV_DESC","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Alt_Desc","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","CODE_SORT","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y0_Dollars","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y1_Dollars","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y2_Dollars","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y0_Qty","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y1_Qty","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y2_Qty","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Qty_OnHand","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Last_Note","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Notes","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address1_Ship","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address2_Ship","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address3_Ship","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address4_Ship","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Address5_Ship","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","City_Ship","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","State_Ship","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Zip_Ship","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Country_Ship","HeaderHAlignment","Center")

	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Salesperson2","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Customer_Ship","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Location","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Product_Line","CellHAlignment","Center")
	'Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","INV_DESC","CellHAlignment","Center")
	'Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Alt_Desc","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","CODE_SORT","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y0_Dollars","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y1_Dollars","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y2_Dollars","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y0_Qty","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y1_Qty","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y2_Qty","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Qty_OnHand","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Notes","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","City_Ship","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","State_Ship","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Zip_Ship","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Country_Ship","CellHAlignment","Center")

	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y0_Dollars","DisplayCustomNumeric","#,###,##0.00")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y1_Dollars","DisplayCustomNumeric","#,###,##0.00")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y2_Dollars","DisplayCustomNumeric","#,###,##0.00")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y0_Qty","DisplayCustomNumeric","####0.####")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y1_Qty","DisplayCustomNumeric","####0.####")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Y2_Qty","DisplayCustomNumeric","####0.####")
	Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","Qty_OnHand","DisplayCustomNumeric","####0.####")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.frmCRM.GsGCSalesHist.SetColumnProperty("gvSalesHist","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf
	
	Gui.frmCRM.GsGCSalesHist.AddSummaryItem("gvSalesHist","Y0_Dollars","Y0_Dollars","Sum","","","n")
	Gui.frmCRM.GsGCSalesHist.AddSummaryItem("gvSalesHist","Y1_Dollars","Y0_Dollars","Sum","","","n")
	Gui.frmCRM.GsGCSalesHist.AddSummaryItem("gvSalesHist","Y2_Dollars","Y0_Dollars","Sum","","","n")
	Gui.frmCRM.GsGCSalesHist.AddSummaryItem("gvSalesHist","Y0_Qty","Y0_Dollars","Sum","","","n")
	Gui.frmCRM.GsGCSalesHist.AddSummaryItem("gvSalesHist","Y1_Qty","Y0_Dollars","Sum","","","n")
	Gui.frmCRM.GsGCSalesHist.AddSummaryItem("gvSalesHist","Y2_Qty","Y0_Dollars","Sum","","","n")
	
	Gui.frmCRM.GsGCSalesHist.ResumeLayout()
	Gui.frmCRM.GsGCSalesHist.MainView("gvSalesHist")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGvSalesHistory.End

Program.Sub.GsGCSalesHist_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sParams.Declare
	V.Local.sCustomer.Declare
	V.Local.iType.Declare
	V.Local.iHandle.Declare
	V.Local.sCaption.Declare

	Gui.frmCRM.GsGCSalesHist.GetCellValueByColumnName("gvSalesHist","Customer",V.Args.RowIndex,V.Local.sCustomer)
	V.Local.iType.Set(15)

	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("Name_Cust_Ship")
			F.Intrinsic.Control.If(V.Screen.frmCRM!optView.Value,=,True)
				F.Intrinsic.String.Build("MODE::9*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}",V.Local.sCustomer,V.Local.iType,V.Local.sParams)
				F.Global.CRM.Invoke(V.Local.sParams,V.Local.iHandle)	
			F.Intrinsic.Control.ElseIf(V.Screen.frmCRM!optView.Value,=,False)
				F.Intrinsic.String.Build("MODE::1*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}",V.Local.sCustomer,V.Local.iType,V.Local.sParams)
				F.Global.CRM.Invoke(V.Local.sParams,V.Local.iHandle)	
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.ExitSub
			
		F.Intrinsic.Control.Case("Notes")
			Gui.frmCRM.GsGCSalesHist.GetCellValueByColumnName("gvSalesHist","Salesperson",V.Args.RowIndex,V.Global.sNTSaleperson)
			Gui.frmCRM.GsGCSalesHist.GetCellValueByColumnName("gvSalesHist","Salesperson2",V.Args.RowIndex,V.Global.sNTSalepersonName)
			Gui.frmCRM.GsGCSalesHist.GetCellValueByColumnName("gvSalesHist","Customer",V.Args.RowIndex,V.Global.sNTCustomer)
			Gui.frmCRM.GsGCSalesHist.GetCellValueByColumnName("gvSalesHist","Name_Cust_Ship",V.Args.RowIndex,V.Global.sNTCustomerName)
			Gui.frmCRM.GsGCSalesHist.GetCellValueByColumnName("gvSalesHist","Part",V.Args.RowIndex,V.Global.sNTPart)
'			Gui.frmCRM.GsGCSalesHist.GetCellValueByColumnName("gvSalesHist","Loc",V.Args.RowIndex,V.Global.sNTLoc)
			F.Intrinsic.String.Build("Notes: {0}-{1}-{2}",V.Global.sNTSalepersonName,V.Global.sNTCustomerName,V.Global.sNTPart,V.Local.sCaption)
			Gui.frmNotes..Caption(V.Local.sCaption)
			F.Intrinsic.Control.CallSub(LoadDtSHNotes)
			F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCSalesHist_RowCellClick.End

Program.Sub.LoadSalesOrders.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtSalesOrders.Exists)
		F.Data.DataTable.Close("dtSalesOrders0")
		F.Data.DataTable.Close("dtSalesOrders")
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.OpenCompanyConnection(300)
	
	F.Intrinsic.Control.SelectCase(V.Screen.frmCRM!ddlOpts.Text)
		F.Intrinsic.Control.Case("All Data")
			F.Data.DataTable.CreateFromSQL("dtSalesOrders","con","Select Distinct A.Customer,E.Name_Customer,Coalesce(B.Part,'') AS Part,'' As DISPLAY_PART,B.Location,B.Description,RTRIM(LTRIM(F.DESCRIPTION_2)) AS ALT_DESC, F.CODE_SORT, B.Product_Line,B.Customer_Part,A.Customer_PO,A.Order_No,Left(B.Record_No,3) As Record_No,Case When B.Flag_Use_Mqd = 'Y' Then C.Cust_Due_Date Else B.Must_Dlvr_By_Date End As Must_Dlvr_By_Date,Case When B.Flag_Use_Mqd = 'Y' Then If(C.Date_Due = '1900-01-01',Convert('9999-12-31',SQL_Date),C.Date_Due) Else B.Date_Item_Prom End As Item_Promise_Dt,Case When B.Flag_Use_Mqd = 'Y' Then Cast(C.Qty_Open As Float) Else Cast(B.Qty_BO As Float) End As Qty_BO,B.Discount_Price As Price,Case When B.Flag_Use_Mqd = 'Y' Then C.Qty_Open*B.Discount_Price When B.Flag_Use_Mqd <> 'Y' Then B.Qty_BO*B.Discount_Price When B.Discount_Price = 0 Then 0.00 End As BO_Extension,Case When B.Flag_Use_Mqd = 'Y' Then DateDiff(Day,C.Date_Due,Now()) Else DateDiff(Day,B.Date_Item_Prom,Now()) End As DateDiff,A.SalesPerson,Cast(Case When B.Flag_Use_Mqd = 'Y' Then 1 Else 0 End As Bit) As Flag_Use_Mqd,D.Notes,B.User_4,B.User_5 From V_Order_Header A Left Join V_Order_Lines B On A.Order_No = B.Order_No Left Join V_OE_Ship_Sched C On B.Order_No = C.Order_No And B.Record_No = C.Order_Line Left Join Gab_4167_SO_Notes D On B.Order_No = D.SO And B.Record_No = CONCAT(D.SOLine,0) Left Join V_Order_Bill_To E On B.Order_No = E.Order_No left join v_inventory_all F on B.Part = F.Part and B.Location = F.Location Where Qty_BO <> 0 And Line_Type <> 'F' And Line_Type <> 'P' Order By Item_Promise_Dt;",True)
			F.Data.DataTable.AddDisplayPartColumn("dtSalesOrders",0,"PART","DISPLAY_PART")
		F.Intrinsic.Control.CaseAny("Salesperson","Customer","Contact")
			F.Intrinsic.String.Build("Select Distinct A.Customer,E.Name_Customer,Coalesce(B.Part,'') AS Part,'' As DISPLAY_PART,B.Location,B.Description,RTRIM(LTRIM(F.DESCRIPTION_2)) AS ALT_DESC, F.CODE_SORT, B.Product_Line,B.Customer_Part,A.Customer_PO,A.Order_No,Left(B.Record_No,3) As Record_No,Case When B.Flag_Use_Mqd = 'Y' Then C.Cust_Due_Date Else B.Must_Dlvr_By_Date End As Must_Dlvr_By_Date,Case When B.Flag_Use_Mqd = 'Y' Then If(C.Date_Due = '1900-01-01',Convert('9999-12-31',SQL_Date),C.Date_Due) Else B.Date_Item_Prom End As Item_Promise_Dt,Case When B.Flag_Use_Mqd = 'Y' Then Cast(C.Qty_Open As Float) Else Cast(B.Qty_BO As Float) End As Qty_BO,B.Discount_Price As Price,Case When B.Flag_Use_Mqd = 'Y' Then C.Qty_Open*B.Discount_Price When B.Flag_Use_Mqd <> 'Y' Then B.Qty_BO*B.Discount_Price When B.Discount_Price = 0 Then 0.00 End As BO_Extension,Case When B.Flag_Use_Mqd = 'Y' Then DateDiff(Day,C.Date_Due,Now()) Else DateDiff(Day,B.Date_Item_Prom,Now()) End As DateDiff,A.SalesPerson,Cast(Case When B.Flag_Use_Mqd = 'Y' Then 1 Else 0 End As Bit) As Flag_Use_Mqd,D.Notes,B.User_4,B.User_5 From V_Order_Header A Left Join V_Order_Lines B On A.Order_No = B.Order_No Left Join V_OE_Ship_Sched C On B.Order_No = C.Order_No And B.Record_No = C.Order_Line Left Join Gab_4167_SO_Notes D On B.Order_No = D.SO And B.Record_No = CONCAT(D.SOLine,0) Left Join V_Order_Bill_To E On B.Order_No = E.Order_No left join v_inventory_all F on B.Part = F.Part and B.Location = F.Location Where Qty_BO <> 0 And Line_Type <> 'F' And Line_Type <> 'P' And A.{0} = '{1}' Order By Item_Promise_Dt;",V.Global.sFieldName,V.Global.sData,V.Local.sSQL)
			F.Data.DataTable.CreateFromSQL("dtSalesOrders","con",V.Local.sSQL,True)
			F.Data.DataTable.AddDisplayPartColumn("dtSalesOrders",0,"PART","DISPLAY_PART")
		F.Intrinsic.Control.CaseAny("Part")
			F.Intrinsic.String.Build("Select Distinct A.Customer,E.Name_Customer,Coalesce(B.Part,'') AS Part,'' As DISPLAY_PART,B.Location,B.Description,RTRIM(LTRIM(F.DESCRIPTION_2)) AS ALT_DESC, F.CODE_SORT, B.Product_Line,B.Customer_Part,A.Customer_PO,A.Order_No,Left(B.Record_No,3) As Record_No,Case When B.Flag_Use_Mqd = 'Y' Then C.Cust_Due_Date Else B.Must_Dlvr_By_Date End As Must_Dlvr_By_Date,Case When B.Flag_Use_Mqd = 'Y' Then If(C.Date_Due = '1900-01-01',Convert('9999-12-31',SQL_Date),C.Date_Due) Else B.Date_Item_Prom End As Item_Promise_Dt,Case When B.Flag_Use_Mqd = 'Y' Then Cast(C.Qty_Open As Float) Else Cast(B.Qty_BO As Float) End As Qty_BO,B.Discount_Price As Price,Case When B.Flag_Use_Mqd = 'Y' Then C.Qty_Open*B.Discount_Price When B.Flag_Use_Mqd <> 'Y' Then B.Qty_BO*B.Discount_Price When B.Discount_Price = 0 Then 0.00 End As BO_Extension,Case When B.Flag_Use_Mqd = 'Y' Then DateDiff(Day,C.Date_Due,Now()) Else DateDiff(Day,B.Date_Item_Prom,Now()) End As DateDiff,A.SalesPerson,Cast(Case When B.Flag_Use_Mqd = 'Y' Then 1 Else 0 End As Bit) As Flag_Use_Mqd,D.Notes,B.User_4,B.User_5 From V_Order_Header A Left Join V_Order_Lines B On A.Order_No = B.Order_No Left Join V_OE_Ship_Sched C On B.Order_No = C.Order_No And B.Record_No = C.Order_Line Left Join Gab_4167_SO_Notes D On B.Order_No = D.SO And B.Record_No = CONCAT(D.SOLine,0) Left Join V_Order_Bill_To E On B.Order_No = E.Order_No left join v_inventory_all F on B.Part = F.Part and B.Location = F.Location Where Qty_BO <> 0 And Line_Type <> 'F' And Line_Type <> 'P' And B.{0} = '{1}' Order By Item_Promise_Dt;",V.Global.sFieldName,V.Global.sData,V.Local.sSQL)
			F.Data.DataTable.CreateFromSQL("dtSalesOrders","con",V.Local.sSQL,True)
			F.Data.DataTable.AddDisplayPartColumn("dtSalesOrders",0,"PART","DISPLAY_PART")
	F.Intrinsic.Control.EndSelect
	
	'Filter Security
	F.Intrinsic.Control.If(V.Global.bAdmin,=,False)
		F.Intrinsic.Control.CallSub(LoadSalesOrdersApplySec)
	F.Intrinsic.Control.Else
		F.Data.DataView.Create("dtSalesOrders","dvSalesOrders")
		F.Data.DataView.ToDataTable("dtSalesOrders","dvSalesOrders","dtSalesOrders0",True)
	F.Intrinsic.Control.EndIf
	
	'Fill Salesperson Name
	F.Data.DataTable.FillFromDictionary("dtSalesOrders0","dSPName","Salesperson")

	F.Intrinsic.Control.CallSub(LoadGvSalesOrders)
	
	F.ODBC.Connection!con.Close
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadSalesOrders.End

Program.Sub.LoadSalesOrdersApplySec.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFilter.Declare
	
	F.Intrinsic.Control.If(V.Global.sLoc,=,"")
	F.Intrinsic.Control.AndIf(V.Global.sSPID,<>,"")
		F.Intrinsic.String.Build("Salesperson = '{0}'",V.Global.sSPID,V.Local.sFilter)
	F.Intrinsic.Control.ElseIf(V.Global.sLoc,<>,"")
	F.Intrinsic.Control.AndIf(V.Global.sSPID,=,"")
		F.Intrinsic.String.Build("Location = '{0}'",V.Global.sLoc,V.Local.sFilter)
	F.Intrinsic.Control.ElseIf(V.Global.sLoc,<>,"")
	F.Intrinsic.Control.AndIf(V.Global.sSPID,<>,"")
		F.Intrinsic.String.Build("Salesperson = '{0}' AND Location = '{1}'",V.Global.sSPID,V.Global.sLoc,V.Local.sFilter)
	F.Intrinsic.Control.ElseIf(V.Global.sLoc,=,"")
	F.Intrinsic.Control.AndIf(V.Global.sSPID,=,"")
		F.Intrinsic.UI.Msgbox(V.Translation.653901,V.Translation.429400)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndIf
	
	F.Data.DataView.Create("dtSalesOrders","dvSalesOrders",22,V.Local.sFilter,"")
	F.Data.DataView.ToDataTable("dtSalesOrders","dvSalesOrders","dtSalesOrders0",True)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadSalesOrdersApplySec.End

Program.Sub.LoadGvSalesOrders.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sCaption.Declare
	
	Gui.frmCRM.GsGCSalesOrders.AddGridViewFromDataTable("gvSalesOrders","dtSalesOrders0")
	Gui.frmCRM.GsGCSalesOrders.SuspendLayout()
	Gui.frmCRM.GsGCSalesOrders.SetGridViewProperty("gvSalesOrders","MultiSelect",True)
	Gui.frmCRM.GsGCSalesOrders.SetGridViewProperty("gvSalesOrders","AllowSort",True)
	Gui.frmCRM.GsGCSalesOrders.SetGridViewProperty("gvSalesOrders","AllowFilter",True)
	Gui.frmCRM.GsGCSalesOrders.SetGridViewProperty("gvSalesOrders","ShowGroupPanel",True)
	Gui.frmCRM.GsGCSalesOrders.SetGridViewProperty("gvSalesOrders","EnableAppearanceOddRow",True)
	Gui.frmCRM.GsGCSalesOrders.SetGridViewProperty("gvSalesOrders","OptionsMenuShowAutoFilterRowItem",False)
	
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer","Caption","Customer No")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Name_Customer","Caption","Customer Name")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","DISPLAY_PART","Caption","Part")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Location","Caption","Loc")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Description","Caption","Description")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","ALT_DESC","Caption","Alt Desc 1")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","CODE_SORT","Caption","Sort Code")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Product_Line","Caption","PL")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer_Part","Caption","Customer Part")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer_PO","Caption","Customer PO")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Order_No","Caption","Order No")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Record_No","Caption","Line")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Must_Dlvr_By_Date","Caption","Cust Due Dt")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Item_Promise_Dt","Caption","Ship Date")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Qty_BO","Caption","B/O Qty")
	F.Intrinsic.String.Build("Unit Price ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Price","Caption",V.Local.sCaption)
	F.Intrinsic.String.Build("Extension ({0})",V.Company.CurrencySymbol,V.Local.sCaption)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","BO_Extension","Caption",V.Local.sCaption)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","DateDiff","Caption","Days Past")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","SalesPerson","Caption","S/P")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Flag_Use_Mqd","Caption","Ship Sched")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Notes","Caption","Notes")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_4","Caption","User Field 4 (30 Characters)")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_5","Caption","User Field 5 (30 Characters)")
	
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Part","Visible",False)
	
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Name_Customer","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","DISPLAY_PART","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Location","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Description","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","ALT_DESC","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","CODE_SORT","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Product_Line","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer_Part","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer_PO","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Order_No","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Record_No","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Must_Dlvr_By_Date","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Item_Promise_Dt","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Qty_BO","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Price","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","BO_Extension","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","DateDiff","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","SalesPerson","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Flag_Use_Mqd","AllowEdit",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Notes","AllowEdit",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_4","AllowEdit",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_5","AllowEdit",True)
	
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Notes","ReadOnly",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_4","ReadOnly",False)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_5","ReadOnly",False)
	
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer","MinWidth","80")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Name_Customer","MinWidth","200")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","DISPLAY_PART","MinWidth","170")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Location","MinWidth","35")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Description","MinWidth","200")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","ALT_DESC","MinWidth","150")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","CODE_SORT","MinWidth","75")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Product_Line","MinWidth","35")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer_Part","MinWidth","150")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer_PO","MinWidth","170")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Order_No","MinWidth","65")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Record_No","MinWidth","35")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Must_Dlvr_By_Date","MinWidth","100")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Item_Promise_Dt","MinWidth","100")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Qty_BO","MinWidth","80")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Price","MinWidth","110")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","BO_Extension","MinWidth","110")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","DateDiff","MinWidth","75")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","SalesPerson","MinWidth","85")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Flag_Use_Mqd","MinWidth","80")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Notes","MinWidth","220")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_4","MinWidth","220")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_5","MinWidth","220")
	
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Name_Customer","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","DISPLAY_PART","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Location","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Description","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","ALT_DESC","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","CODE_SORT","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Product_Line","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer_Part","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer_PO","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Order_No","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Record_No","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Must_Dlvr_By_Date","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Item_Promise_Dt","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Qty_BO","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Price","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","BO_Extension","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","DateDiff","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","SalesPerson","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Flag_Use_Mqd","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Notes","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_4","HeaderFontBold",True)
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_5","HeaderFontBold",True)
	
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Name_Customer","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","DISPLAY_PART","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Location","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Description","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","ALT_DESC","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","CODE_SORT","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Product_Line","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer_Part","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer_PO","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Order_No","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Record_No","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Must_Dlvr_By_Date","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Item_Promise_Dt","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Qty_BO","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Price","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","BO_Extension","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","DateDiff","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","SalesPerson","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Flag_Use_Mqd","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Notes","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_4","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_5","HeaderHAlignment","Center")
	
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Location","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Product_Line","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Order_No","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Record_No","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Must_Dlvr_By_Date","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Item_Promise_Dt","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","DateDiff","CellHAlignment","Center")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Flag_Use_Mqd","CellHAlignment","Center")

	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Customer","Fixed","Left")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Name_Customer","Fixed","Left")

	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Name_Customer","CellForeColor","Blue")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Order_No","CellForeColor","Blue")
	
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Notes","CellBackColor","LightYellow")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_4","CellBackColor","LightYellow")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","User_5","CellBackColor","LightYellow")

	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Qty_BO","DisplayCustomNumeric","#,###,##0.00")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Price","DisplayCustomNumeric","#,###,##0.00")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","BO_Extension","DisplayCustomNumeric","#,###,##0.00")

	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Must_Dlvr_By_Date","DisplayCustomDatetime","d")
	Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","Item_Promise_Dt","DisplayCustomDatetime","d")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.frmCRM.GsGCSalesOrders.SetColumnProperty("gvSalesOrders","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf
	
	Gui.frmCRM.GsGCSalesOrders.AddSummaryItem("gvSalesOrders","BO_Extension","BO_Extension","Sum","","","n")
	
	Gui.frmCRM.GsGCSalesOrders.ResumeLayout()
	Gui.frmCRM.GsGCSalesOrders.MainView("gvSalesOrders")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGvSalesOrders.End

Program.Sub.GsGCSalesOrders_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sCustomer.Declare
	V.Local.iType.Declare
	V.Local.sOrderNo.Declare

	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("Name_Customer")
			Gui.frmCRM.GsGCSalesOrders.GetCellValueByColumnName("gvSalesOrders","Customer",V.Args.RowIndex,V.Local.sCustomer)
			V.Local.iType.Set(15)
			F.Intrinsic.Control.If(V.Screen.frmCRM!optView1.Value)
				F.Intrinsic.String.Build("MODE::9*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}",V.Local.sCustomer,V.Local.iType,V.Local.sParams)
				F.Global.CRM.Invoke(V.Local.sParams,V.Local.iHandle)	
			F.Intrinsic.Control.ElseIf(V.Screen.frmCRM!optEdit1.Value)
				F.Intrinsic.String.Build("MODE::1*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}",V.Local.sCustomer,V.Local.iType,V.Local.sParams)
				F.Global.CRM.Invoke(V.Local.sParams,V.Local.iHandle)	
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.ExitSub
			
		F.Intrinsic.Control.Case("Order_No")
			Gui.frmCRM.GsGCSalesOrders.GetCellValueByColumnName("gvSalesOrders","Order_No",V.Args.RowIndex,V.Local.sOrderNo)
			F.Intrinsic.Control.If(V.Screen.frmCRM!optEdit1.Value)
				F.Intrinsic.String.Concat(V.Local.sOrderNo,"!*!O!*!*!*ZDR*!*",V.Local.sOrderNo)
				F.Global.General.CallWrapperSync(200000,V.Local.sOrderNo)
			F.Intrinsic.Control.ElseIf(V.Screen.frmCRM!optShip1.Value)
				F.Global.General.CallWrapperSync(4010,V.Local.sOrderNo)
			F.Intrinsic.Control.Else
				f.Intrinsic.String.Concat(V.Local.sOrderNo,"!*!V!*!*!*ZDR*!*",V.Local.sOrderNo)
				f.Global.General.CallWrapperSync(200000,V.Local.sOrderNo)
			F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCSalesOrders_RowCellClick.End

Program.Sub.GsGCSalesOrders_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sOrder.Declare
	V.Local.sSOLine.Declare
	V.Local.sLine.Declare
	V.Local.sText.Declare
	V.Local.sTextTbl.Declare
	
	F.ODBC.Connection!con.OpenCompanyConnection(300)

	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.Case("NOTES")
			Gui.frmCRM.GsGCSalesOrders.GetCellValueByColumnName("gvSalesOrders","Order_No",V.Args.RowIndex,V.Local.sOrder)
			Gui.frmCRM.GsGCSalesOrders.GetCellValueByColumnName("gvSalesOrders","Record_No",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("Select * From GAB_4167_SO_NOTES Where SO = '{0}' And SOLINE = '{1}';",V.Local.sOrder,V.Local.sLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("Insert Into GAB_4167_SO_NOTES(SO,SOLINE,NOTES) Values('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Update GAB_4167_SO_NOTES Set NOTES = '{0}' Where SO = '{1}' And SOLINE = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close

		F.Intrinsic.Control.Case("User_4")
			Gui.frmCRM.GsGCSalesOrders.GetCellValueByColumnName("gvSalesOrders","Order_No",V.Args.RowIndex,V.Local.sOrder)
			Gui.frmCRM.GsGCSalesOrders.GetCellValueByColumnName("gvSalesOrders","Record_No",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sSOLine)
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("Select * From Order_Lines Where Order_No = '{0}' And Record_No = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("Insert Into Order_Lines(Order_No,Record_No,User_4) Values('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Update Order_Lines Set User_4 = '{0}' Where Order_No = '{1}' And Record_No = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close

		F.Intrinsic.Control.Case("User_5")
			Gui.frmCRM.GsGCSalesOrders.GetCellValueByColumnName("gvSalesOrders","Order_No",V.Args.RowIndex,V.Local.sOrder)
			Gui.frmCRM.GsGCSalesOrders.GetCellValueByColumnName("gvSalesOrders","Record_No",V.Args.RowIndex,V.Local.sLine)
			F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sSOLine)
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("Select * From Order_Lines Where Order_No = '{0}' And Record_No = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("Insert Into Order_Lines(Order_No,Record_No,User_5) Values('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("Update Order_Lines Set User_5 = '{0}' Where Order_No = '{1}' And Record_No = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
	F.Intrinsic.Control.EndSelect
	
	F.ODBC.Connection!con.Close
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCSalesOrders_CellValueChanged.End

Program.Sub.LoadQuotes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtQuotes.Exists)
		F.Data.DataTable.Close("dtQuotes")
		F.Data.DataTable.Close("dtQuotes0")
		F.Data.Dictionary.Close("dSO")
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.OpenCompanyConnection(300)
	
	F.Intrinsic.Control.SelectCase(V.Screen.frmCRM!ddlOpts.Text)
		F.Intrinsic.Control.Case("All Data")
			F.Intrinsic.String.Build("Select Distinct A.Customer,B.Name,A.Customer_PO,A.Quote_No,Right(C.Record_No,3)+'-'+Left(C.Record_No,1) As Record_No,Coalesce(C.Part,'') AS Part,'' As DISPLAY_PART,C.Location,C.Description,RTRIM(LTRIM(D.DESCRIPTION_2)) AS ALT_DESC, D.CODE_SORT, C.Product_Line,C.Qty_Quoted,C.Discount_Price As Price,C.Extension As Line_Ext,Case C.Quote_Won When 'C' Then 'Closed' When 'W' Then 'Won' When 'L' Then 'Loss' Else '' End As Quote_Won,A.Date_Quote,Case When C.Date_Item_Prom = '1900-01-01' Then A.Date_Due Else C.Date_Item_Prom End As Date_Due,(Select Sum(Extension) From V_Quote_Lines Where A.Quote_No = V_Quote_Lines.Quote_No) As Qte_Ext,A.Salesperson,'' As SalesOrder,RTrim(C.User_5) As User_5 From V_Quote_Header A Left Join Cust_Prosp_List B On A.Customer = B.Prospect Left Join V_Quote_Lines C On A.Quote_No = C.Quote_No LEFT JOIN V_INVENTORY_ALL D ON C.PART = D.PART AND C.LOCATION = D.LOCATION Where Date_Due >= Cast(DateAdd(Day,-{0},CurDate()) As Date) Order By Date_Due Desc,A.Quote_No,Record_No;",V.Screen.frmCRM!txtDays.Text,V.Local.sSQL)
		F.Intrinsic.Control.CaseAny("Salesperson","Customer","Contact")
			F.Intrinsic.String.Build("Select Distinct A.Customer,B.Name,A.Customer_PO,A.Quote_No,Right(C.Record_No,3)+'-'+Left(C.Record_No,1) As Record_No,Coalesce(C.Part,'') AS Part,'' As DISPLAY_PART,C.Location,C.Description,RTRIM(LTRIM(D.DESCRIPTION_2)) AS ALT_DESC, D.CODE_SORT, C.Product_Line,C.Qty_Quoted,C.Discount_Price As Price,C.Extension As Line_Ext,Case C.Quote_Won When 'C' Then 'Closed' When 'W' Then 'Won' When 'L' Then 'Loss' Else '' End As Quote_Won,A.Date_Quote,Case When C.Date_Item_Prom = '1900-01-01' Then A.Date_Due Else C.Date_Item_Prom End As Date_Due,(Select Sum(Extension) From V_Quote_Lines Where A.Quote_No = V_Quote_Lines.Quote_No) As Qte_Ext,A.Salesperson,'' As SalesOrder,RTrim(C.User_5) As User_5 From V_Quote_Header A Left Join Cust_Prosp_List B On A.Customer = B.Prospect Left Join V_Quote_Lines C On A.Quote_No = C.Quote_No LEFT JOIN V_INVENTORY_ALL D ON C.PART = D.PART AND C.LOCATION = D.LOCATION WHERE Date_Due >= Cast(DateAdd(Day,-{0},CurDate()) As Date) And A.{1} = '{2}' Order By Date_Due Desc,A.Quote_No,Record_No;",V.Screen.frmCRM!txtDays.Text,V.Global.sFieldName,V.Global.sData,V.Local.sSQL)
		F.Intrinsic.Control.CaseAny("Part")
			F.Intrinsic.String.Build("Select Distinct A.Customer,B.Name,A.Customer_PO,A.Quote_No,Right(C.Record_No,3)+'-'+Left(C.Record_No,1) As Record_No,Coalesce(C.Part,'') AS Part,'' As DISPLAY_PART,C.Location,C.Description,RTRIM(LTRIM(D.DESCRIPTION_2)) AS ALT_DESC, D.CODE_SORT, C.Product_Line,C.Qty_Quoted,C.Discount_Price As Price,C.Extension As Line_Ext,Case C.Quote_Won When 'C' Then 'Closed' When 'W' Then 'Won' When 'L' Then 'Loss' Else '' End As Quote_Won,A.Date_Quote,Case When C.Date_Item_Prom = '1900-01-01' Then A.Date_Due Else C.Date_Item_Prom End As Date_Due,(Select Sum(Extension) From V_Quote_Lines Where A.Quote_No = V_Quote_Lines.Quote_No) As Qte_Ext,A.Salesperson,'' As SalesOrder,RTrim(C.User_5) As User_5 From V_Quote_Header A Left Join Cust_Prosp_List B On A.Customer = B.Prospect Left Join V_Quote_Lines C On A.Quote_No = C.Quote_No LEFT JOIN V_INVENTORY_ALL D ON C.PART = D.PART AND C.LOCATION = D.LOCATION WHERE Date_Due >= Cast(DateAdd(Day,-{0},CurDate()) As Date) And C.{1} = '{2}' Order By Date_Due Desc,A.Quote_No,Record_No;",V.Screen.frmCRM!txtDays.Text,V.Global.sFieldName,V.Global.sData,V.Local.sSQL)
	F.Intrinsic.Control.EndSelect
	
	F.Data.DataTable.CreateFromSQL("dtQuotes","con",V.Local.sSQL,True)
	F.Data.DataTable.AddDisplayPartColumn("dtQuotes",0,"PART","DISPLAY_PART")
	
	'Filter Security
	F.Intrinsic.Control.If(V.Global.bAdmin,=,False)
		F.Intrinsic.Control.CallSub(LoadQuotesApplySec)
	F.Intrinsic.Control.Else
		F.Data.DataView.Create("dtQuotes","dvQuotes")
		F.Data.DataView.ToDataTable("dtQuotes","dvQuotes","dtQuotes0",True)
	F.Intrinsic.Control.EndIf
	
	'Fill Salesperson Name
	F.Data.DataTable.FillFromDictionary("dtQuotes0","dSPName","Salesperson")
	
	'Fill Sale Order
	F.Data.Dictionary.CreateFromSQL("dSO","con","Select Quote,Order_No From V_Order_Header Where Quote <> '';")
	F.Data.Dictionary.SetDefaultReturn("dSO","")
	F.Data.DataTable.FillFromDictionary("dtQuotes","dSO","Quote_No","SalesOrder")

	F.Intrinsic.Control.CallSub(LoadGvQuotes)
	
	F.ODBC.Connection!con.Close
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadQuotes.End

Program.Sub.LoadQuotesApplySec.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFilter.Declare
	
	F.Intrinsic.Control.If(V.Global.sLoc,=,"")
	F.Intrinsic.Control.AndIf(V.Global.sSPID,<>,"")
		F.Intrinsic.String.Build("Salesperson = '{0}'",V.Global.sSPID,V.Local.sFilter)
	F.Intrinsic.Control.ElseIf(V.Global.sLoc,<>,"")
	F.Intrinsic.Control.AndIf(V.Global.sSPID,=,"")
		F.Intrinsic.String.Build("Location = '{0}'",V.Global.sLoc,V.Local.sFilter)
	F.Intrinsic.Control.ElseIf(V.Global.sLoc,<>,"")
	F.Intrinsic.Control.AndIf(V.Global.sSPID,<>,"")
		F.Intrinsic.String.Build("Salesperson = '{0}' AND Location = '{1}'",V.Global.sSPID,V.Global.sLoc,V.Local.sFilter)
	F.Intrinsic.Control.ElseIf(V.Global.sLoc,=,"")
	F.Intrinsic.Control.AndIf(V.Global.sSPID,=,"")
		F.Intrinsic.UI.Msgbox(V.Translation.653901,V.Translation.429400)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndIf
	
	F.Data.DataView.Create("dtQuotes","dvQuotes",22,V.Local.sFilter,"")
	F.Data.DataView.ToDataTable("dtQuotes","dvQuotes","dtQuotes0",True)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadQuotesApplySec.End

Program.Sub.LoadGvQuotes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmCRM.GsGCQuotes.AddGridViewFromDataTable("gvQuotes","dtQuotes0")
	Gui.frmCRM.GsGCQuotes.SuspendLayout()
	Gui.frmCRM.GsGCQuotes.SetGridViewProperty("gvQuotes","MultiSelect",True)
	Gui.frmCRM.GsGCQuotes.SetGridViewProperty("gvQuotes","AllowSort",True)
	Gui.frmCRM.GsGCQuotes.SetGridViewProperty("gvQuotes","AllowFilter",True)
	Gui.frmCRM.GsGCQuotes.SetGridViewProperty("gvQuotes","ShowGroupPanel",True)
	Gui.frmCRM.GsGCQuotes.SetGridViewProperty("gvQuotes","EnableAppearanceOddRow",True)
	
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer","Visible",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Part","Visible",False)
	
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer","Caption","Customer")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Name","Caption","Customer Name")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer_PO","Caption","Customer PO")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_No","Caption","Quote No")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Record_No","Caption","Line")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","DISPLAY_PART","Caption","Part Number")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Location","Caption","Loc")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Description","Caption","Description")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","ALT_DESC","Caption","Alt Desc 1")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","CODE_SORT","Caption","Sort Code")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Product_Line","Caption","PL")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qty_Quoted","Caption","Quoted Qty")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Price","Caption","Price")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Line_Ext","Caption","Line Extension")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_Won","Caption","W/L/C")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Quote","Caption","Quote Date")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Due","Caption","Due Date")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qte_Ext","Caption","Quote Extension")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Salesperson","Caption","Salesperson")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","SalesOrder","Caption","Sales Order")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","User_5","Caption","User 5")
	
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Name","CellForeColor","Blue")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_No","CellForeColor","Blue")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","User_5","CellBackColor","LightYellow")
	
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Name","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer_PO","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_No","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Record_No","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","DISPLAY_PART","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Location","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Description","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","ALT_DESC","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","CODE_SORT","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Product_Line","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qty_Quoted","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Price","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Line_Ext","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_Won","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Quote","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Due","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qte_Ext","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Salesperson","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","SalesOrder","AllowEdit",False)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","User_5","AllowEdit",True)
	
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","User_5","ReadOnly",False)
	
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer","MinWidth","65")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Name","MinWidth","150")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer_PO","MinWidth","105")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_No","MinWidth","85")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Record_No","MinWidth","65")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","DISPLAY_PART","MinWidth","130")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Location","MinWidth","30")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Description","MinWidth","200")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","ALT_DESC","MinWidth","150")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","CODE_SORT","MinWidth","75")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Product_Line","MinWidth","30")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qty_Quoted","MinWidth","85")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Price","MinWidth","85")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Line_Ext","MinWidth","95")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_Won","MinWidth","65")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Quote","MinWidth","85")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Due","MinWidth","85")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qte_Ext","MinWidth","100")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Salesperson","MinWidth","130")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","SalesOrder","MinWidth","85")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","User_5","MinWidth","175")
	
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Name","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer_PO","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_No","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Record_No","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","DISPLAY_PART","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Location","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Description","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","ALT_DESC","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","CODE_SORT","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Product_Line","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qty_Quoted","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Price","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Line_Ext","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_Won","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Quote","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Due","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qte_Ext","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Salesperson","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","SalesOrder","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","User_5","HeaderHAlignment","Center")
	
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Name","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer_PO","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_No","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Record_No","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","DISPLAY_PART","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Location","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Description","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","ALT_DESC","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","CODE_SORT","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Product_Line","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qty_Quoted","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Price","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Line_Ext","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_Won","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Quote","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Due","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qte_Ext","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Salesperson","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","SalesOrder","HeaderFontBold",True)
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","User_5","HeaderFontBold",True)
	
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Customer_PO","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_No","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Record_No","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Product_Line","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qty_Quoted","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Price","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Line_Ext","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Quote_Won","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Quote","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Due","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qte_Ext","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Salesperson","CellHAlignment","Center")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","SalesOrder","CellHAlignment","Center")
	
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Record_No","DisplayCustomString","00#-#")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qty_Quoted","DisplayCustomNumeric","#####0.0000")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Price","DisplayCustomNumeric","$#####0.00")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Line_Ext","DisplayCustomNumeric","$#####0.00")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Qte_Ext","DisplayCustomNumeric","$#####0.00")

	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Quote","DisplayCustomDatetime","d")
	Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","Date_Due","DisplayCustomDatetime","d")
	
	F.Intrinsic.Control.If(V.Global.bLongPart)
		Gui.frmCRM.GsGCQuotes.SetColumnProperty("gvQuotes","DISPLAY_PART","MinWidth","250")
	F.Intrinsic.Control.EndIf
	
	Gui.frmCRM.GsGCQuotes.ResumeLayout()
	Gui.frmCRM.GsGCQuotes.MainView("gvQuotes")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGvQuotes.End

Program.Sub.GsGCQuotes_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sParams.Declare
	V.Local.sCustomer.Declare
	V.Local.iType.Declare
	V.Local.iHandle.Declare
	V.Local.sQte.Declare
	V.Local.sQteLine.Declare

	Gui.frmCRM.GsGCQuotes.GetCellValueByColumnName("gvQuotes","Customer",V.Args.RowIndex,V.Local.sCustomer)
	V.Local.iType.Set(15)

	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("Company")
			F.Intrinsic.Control.If(V.Screen.frmCRM!optView.Value,=,True)
				F.Intrinsic.String.Build("MODE::9*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}",V.Local.sCustomer,V.Local.iType,V.Local.sParams)
				F.Global.CRM.Invoke(V.Local.sParams,V.Local.iHandle)	
			F.Intrinsic.Control.ElseIf(V.Screen.frmCRM!optView.Value,=,False)
				F.Intrinsic.String.Build("MODE::1*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}",V.Local.sCustomer,V.Local.iType,V.Local.sParams)
				F.Global.CRM.Invoke(V.Local.sParams,V.Local.iHandle)	
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Case("Quote_No")
			Gui.frmCRM.GsGCQuotes.GetCellValueByColumnName("gvQuotes","Quote_No",v.Args.RowIndex,v.Local.sQte)
			Gui.frmCRM.GsGCQuotes.GetCellValueByColumnName("gvQuotes","Record_No",v.Args.RowIndex,v.Local.sQteLine)
			F.Intrinsic.Control.If(V.Screen.frmCRM!optView2.Value)
				F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sQte,"V","*!*ZDR*!*",V.Local.sParams)
				F.Global.General.CallWrapperASync(251000,V.Local.sParams)
			F.Intrinsic.Control.ElseIf(V.Screen.frmCRM!optEdit2.Value)
				F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sQte,"O","*!*ZDR*!*",V.Local.sParams)
				F.Global.General.CallWrapperASync(251000,V.Local.sParams)
			F.Intrinsic.Control.ElseIf(V.Screen.frmCRM!optWLC.Value)
				F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sQte,V.Local.sQteLine,"G","",V.Local.sParams)
				F.Global.General.CallWrapperAsync(3801,V.Local.sParams)
			F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCQuotes_RowCellClick.End

Program.Sub.GsGCQuotes_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sQuoteNo.Declare
	V.Local.sQuoteLn.Declare
	V.Local.sText.Declare

	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("User_5")
			F.ODBC.Connection!con.OpenCompanyConnection(300)
			Gui.frmCRM.GsGCQuotes.GetCellValueByColumnName("gvQuotes","Quote_No",V.Args.RowIndex,v.Local.sQuoteNo)
			Gui.frmCRM.GsGCQuotes.GetCellValueByColumnName("gvQuotes","Record_No",V.Args.RowIndex,v.Local.sQuoteLn)
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sText)
			F.Intrinsic.String.Left(V.Local.sQuoteLn,3,V.Local.sQuoteLn)
			F.Intrinsic.String.LPad(V.Local.sQuoteLn,"0",4,V.Local.sQuoteLn)
			F.Intrinsic.String.Build("Update Quote_Lines Set User_5 = '{0}' Where Record_Type = 'L' And Quote_No = '{1}' And Record_No = '{2}';",v.Local.sText,v.Local.sQuoteNo,V.Local.sQuoteLn,v.Local.sSQL)
			F.ODBC.Connection!con.Execute(v.Local.sSQL)
			F.ODBC.Connection!con.Close
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCQuotes_CellValueChanged.End

Program.Sub.GetDistinctCustomersCRM.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtSalesHistCust.Exists)
		F.Data.DataTable.Close("dtSalesHistCust")
		F.Data.DataTable.Close("dtSalesOrdersCust")
		F.Data.DataTable.Close("dtQuotesCust")
		F.Data.DataTable.Close("dtDistinctCust")
	F.Intrinsic.Control.EndIf
	
	'Distinct Customers from Sales History
	F.Data.DataView.Create("dtSalesHist0","dvSalesHist")
	F.Data.DataView.ToDataTableDistinct("dtSalesHist0","dvSalesHist","dtSalesHistCust","Customer",True)
	F.Data.DataView.Close("dtSalesHist0","dvSalesHist")
	'Distinct Customers from Sales Orders
	F.Data.DataView.Create("dtSalesOrders0","dvSalesOrdersCust")
	F.Data.DataView.ToDataTableDistinct("dtSalesOrders0","dvSalesOrdersCust","dtSalesOrdersCust","Customer",True)
	F.Data.DataView.Close("dtSalesOrders0","dvSalesOrdersCust")
	'Distinct Customers from Quotes
	F.Data.DataView.Create("dtQuotes0","dvQuotesCust")
	F.Data.DataView.ToDataTableDistinct("dtQuotes0","dvQuotesCust","dtQuotesCust","Customer",True)
	F.Data.DataView.Close("dtQuotes0","dvQuotesCust")
	'Megre Distinct Customers Above
	F.Data.DataTable.Merge("dtSalesOrdersCust","dtSalesHistCust",True,3)
	F.Data.DataTable.Merge("dtQuotesCust","dtSalesHistCust",True,3)
	'Distinct customers from merge
	F.Data.DataView.Create("dtSalesHistCust","dvSalesHistCust")
	F.Data.DataView.ToDataTableDistinct("dtSalesHistCust","dvSalesHistCust","dtDistinctCust","Customer",True)
	
	'Create string for query
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtDistinctCust.RowCount--,1)
		F.Intrinsic.Control.If(V.Local.iCnt,=,0)
			F.Intrinsic.String.Build("'{0}'",V.DataTable.dtDistinctCust(V.Local.iCnt).Customer!FieldValTrim,V.Global.sCustomers.Trim)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0},'{1}'",V.Global.sCustomers,V.DataTable.dtDistinctCust(V.Local.iCnt).Customer!FieldValTrim,V.Global.sCustomers)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GetDistinctCustomersCRM.End

Program.Sub.LoadOppor.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sFilter.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtOppor.Exists)
		F.Data.DataTable.Close("dtOppor")
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.OpenCompanyConnection(300)
	
	F.Intrinsic.Control.SelectCase(V.Screen.frmCRM!ddlOpts.Text)
		F.Intrinsic.Control.Case("All Data")
			F.Data.DataTable.CreateFromSQL("dtOppor0","con","Select A.CompID As Company,If(Case CompType When 15 Then B.Name_Customer When 18 Then C.Name_Prospect When 19 Then C.Name_Prospect End Is Null,'',Case CompType When 15 Then B.Name_Customer When 18 Then C.Name_Prospect When 19 Then C.Name_Prospect End) As CompanyName,Case CompType When 15 Then 'C' When 18 Then 'P' When 19 Then 'S' End As CPS,RTrim(A.ODesc) As Description,RTrim(D.Value) As Type,RTrim(E.OGDesc) As GroupDesc,RTrim(K.Name) As Contact,A.SalesOrder As SalesOrder,A.Quote As Quote,A.ORevenue As Revenue,RTrim(J.Name) As Salesperson,A.Int_Assign As Int_Assign,RTrim(F.Value) As Status,RTrim(G.Value) As Funnel,RTrim(H.Value) As Probability,RTrim(I.Value) As LeadSource,A.OCreateDate As CreateDate,A.OProjCloseDate As ProjClosedDate,A.OCloseDate As CloseDate,RTrim(L.Value) As CloseReason,CompType As CompType From CRM_OPP_MASTER A Left Join V_CUSTOMER_MASTER B ON A.CompID = B.Customer Left Join PROSPECT_MASTER C ON A.CompID = C.Prospect Left Join CRM_OPP_TYPE D ON A.OType = D.Seq Left Join CRM_OPPGROUPING E ON A.OGID = E.OGID Left Join CRM_OPP_STATUS F ON A.OStatus = F.Seq Left Join CRM_OPP_FUNNEL G ON A.OFunnel = G.Seq Left Join CRM_OPP_PROB H ON A.OProb = H.ID AND A.OFunnel = H.FunnelID Left Join CRM_OPP_LEADSOURCE I ON A.OLeadSource = I.Seq Left Join SALESPERSONS J ON A.Salesperson = J.ID Left Join CONTACT K ON A.CompID = K.Cust AND A.CID = K.Alt_ID Left Join CRM_OPP_CLSRSN L ON A.OCloseReason = L.Seq Where A.CompType <> 10 Order By A.CompID;",True)
			V.Local.sFilter.Set("")
			F.Intrinsic.Control.If(V.Global.bAdmin,=,False)
				F.Intrinsic.Control.CallSub(GetDistinctCustomersCRM)
				F.Intrinsic.String.Build("Company In ({0})",V.Global.sCustomers,V.Local.sFilter)
			F.Intrinsic.Control.EndIf
			F.Data.DataView.Create("dtOppor0","dvOppor",22,V.Local.sFilter,"")
			F.Data.DataView.ToDataTable("dtOppor0","dvOppor","dtOppor",True)
			F.Data.DataTable.Close("dtOppor0")
		F.Intrinsic.Control.CaseAny("Salesperson","Customer","Contact","Part")
			F.Intrinsic.String.Build("Select A.CompID As Company,If(Case CompType When 15 Then B.Name_Customer When 18 Then C.Name_Prospect When 19 Then C.Name_Prospect End Is Null,'',Case CompType When 15 Then B.Name_Customer When 18 Then C.Name_Prospect When 19 Then C.Name_Prospect End) As CompanyName,Case CompType When 15 Then 'C' When 18 Then 'P' When 19 Then 'S' End As CPS,RTrim(A.ODesc) As Description,RTrim(D.Value) As Type,RTrim(E.OGDesc) As GroupDesc,RTrim(K.Name) As Contact,A.SalesOrder As SalesOrder,A.Quote As Quote,A.ORevenue As Revenue,RTrim(J.Name) As Salesperson,A.Int_Assign As Int_Assign,RTrim(F.Value) As Status,RTrim(G.Value) As Funnel,RTrim(H.Value) As Probability,RTrim(I.Value) As LeadSource,A.OCreateDate As CreateDate,A.OProjCloseDate As ProjClosedDate,A.OCloseDate As CloseDate,RTrim(L.Value) As CloseReason,CompType As CompType From CRM_OPP_MASTER A Left Join V_CUSTOMER_MASTER B ON A.CompID = B.Customer Left Join PROSPECT_MASTER C ON A.CompID = C.Prospect Left Join CRM_OPP_TYPE D ON A.OType = D.Seq Left Join CRM_OPPGROUPING E ON A.OGID = E.OGID Left Join CRM_OPP_STATUS F ON A.OStatus = F.Seq Left Join CRM_OPP_FUNNEL G ON A.OFunnel = G.Seq Left Join CRM_OPP_PROB H ON A.OProb = H.ID AND A.OFunnel = H.FunnelID Left Join CRM_OPP_LEADSOURCE I ON A.OLeadSource = I.Seq Left Join SALESPERSONS J ON A.Salesperson = J.ID Left Join CONTACT K ON A.CompID = K.Cust AND A.CID = K.Alt_ID Left Join CRM_OPP_CLSRSN L ON A.OCloseReason = L.Seq Where A.CompType <> 10 And A.CompID In ({0}) Order By A.CompID;",V.Global.sCustomers,V.Local.sSQL)
			F.Data.DataTable.CreateFromSQL("dtOppor","con",V.Local.sSQL,True)
	F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.CallSub(LoadGvOppor)
	F.Intrinsic.Control.CallSub(LoadgsChartOpps)
	
	F.ODBC.Connection!con.Close
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadOppor.End

Program.Sub.LoadGvOppor.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmCRM.GsGCOppor.AddGridViewFromDataTable("gvOppor","dtOppor")
	Gui.frmCRM.GsGCOppor.SuspendLayout()
	Gui.frmCRM.GsGCOppor.SetGridViewProperty("gvOppor","MultiSelect",True)
	Gui.frmCRM.GsGCOppor.SetGridViewProperty("gvOppor","AllowSort",True)
	Gui.frmCRM.GsGCOppor.SetGridViewProperty("gvOppor","AllowFilter",True)
	Gui.frmCRM.GsGCOppor.SetGridViewProperty("gvOppor","Editable",False)
	Gui.frmCRM.GsGCOppor.SetGridViewProperty("gvOppor","ShowGroupPanel",True)
	Gui.frmCRM.GsGCOppor.SetGridViewProperty("gvOppor","EnableAppearanceOddRow",True)

	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CompType","Visible",False)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Company","Visible",False)

	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Company","Caption","Number")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CompanyName","Caption","Name")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CPS","Caption","C/P/S")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Description","Caption","Description")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Type","Caption","Type")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","GroupDesc","Caption","Group")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Contact","Caption","Contact")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","SalesOrder","Caption","Sales Orders")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Quote","Caption","Quotes")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Revenue","Caption","Revenue")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Salesperson","Caption","Sales Person")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Int_Assign","Caption","Interal Assignment")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Status","Caption","Status")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Funnel","Caption","Funnel")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Probability","Caption","Probability")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","LeadSource","Caption","Leadsource")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CreateDate","Caption","Create Date")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","ProjClosedDate","Caption","Proj. Closed Date")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CloseDate","Caption","Closed Date")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CloseReason","Caption","Close Reason")

	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CompanyName","CellForeColor","Blue")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","SalesOrder","CellForeColor","Blue")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Quote","CellForeColor","Blue")

	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Company","MinWidth","35")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CompanyName","MinWidth","200")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CPS","MinWidth","50")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Description","MinWidth","400")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Type","MinWidth","150")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","GroupDesc","MinWidth","225")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Contact","MinWidth","100")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","SalesOrder","MinWidth","85")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Quote","MinWidth","75")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Revenue","MinWidth","75")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Salesperson","MinWidth","150")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Int_Assign","MinWidth","155")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Status","MinWidth","155")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Funnel","MinWidth","155")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Probability","MinWidth","155")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","LeadSource","MinWidth","155")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CreateDate","MinWidth","75")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","ProjClosedDate","MinWidth","95")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CloseDate","MinWidth","75")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CloseReason","MinWidth","155")

	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Company","Fixed","Left")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CompanyName","Fixed","Left")

	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Company","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CompanyName","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CPS","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Description","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Type","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","GroupDesc","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Contact","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","SalesOrder","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Quote","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Revenue","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Salesperson","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Int_Assign","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Status","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Funnel","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Probability","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","LeadSource","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CreateDate","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","ProjClosedDate","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CloseDate","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CloseReason","HeaderHAlignment","Center")
	
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Company","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CompanyName","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CPS","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Description","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Type","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","GroupDesc","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Contact","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","SalesOrder","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Quote","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Revenue","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Salesperson","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Int_Assign","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Status","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Funnel","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Probability","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","LeadSource","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CreateDate","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","ProjClosedDate","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CloseDate","HeaderFontBold",True)
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CloseReason","HeaderFontBold",True)
	
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Company","CellHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CPS","CellHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Contact","CellHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","SalesOrder","CellHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Quote","CellHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Revenue","CellHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Salesperson","CellHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Int_Assign","CellHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CreateDate","CellHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","ProjClosedDate","CellHAlignment","Center")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CloseDate","CellHAlignment","Center")

	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","Revenue","DisplayCustomNumeric","$#######.00")

	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CreateDate","DisplayCustomDatetime","d")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","ProjClosedDate","DisplayCustomDatetime","d")
	Gui.frmCRM.GsGCOppor.SetColumnProperty("gvOppor","CloseDate","DisplayCustomDatetime","d")
	
	Gui.frmCRM.GsGCOppor.ResumeLayout()
	Gui.frmCRM.GsGCOppor.MainView("gvOppor")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGvOppor.End

Program.Sub.LoadgsChartOpps.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.sDataTitles.Declare
	V.Local.sData.Declare
	V.Local.sFilter.Declare
	V.Local.iCompute.Declare
	V.Local.sCompany.Declare
	V.Local.sCompanies.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtOpporCust.Exists)
		F.Data.DataTable.Close("dtOpporCust")
	F.Intrinsic.Control.EndIf
	
	'Opportunities by Type
	F.Data.DataTable.Compute("dtOppor","Count(Company)","CPS = 'C'",V.Local.iCompute)
	F.Intrinsic.Control.If(V.Local.iCompute,<>,0)
		V.Local.sDataTitles.Set("Customer")
		V.Local.sData.Set(V.Local.iCompute)
		V.Local.iCnt.Set(1)
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.Compute("dtOppor","Count(Company)","CPS = 'P'",V.Local.iCompute)
	F.Intrinsic.Control.If(V.Local.iCompute,<>,0)
		F.Intrinsic.Control.If(V.Local.iCnt,<>,1)
			V.Local.sDataTitles.Set("Prospects")
			V.Local.sData.Set(V.Local.iCompute)
			V.Local.iCnt.Set(1)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}*!*Prospects",V.Local.sDataTitles,V.Local.sDataTitles)
			F.Intrinsic.String.Build("{0}*!*{1}",V.Local.sData,V.Local.iCompute,V.Local.sData)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.Compute("dtOppor","Count(Company)","CPS = 'S'",V.Local.iCompute)
	F.Intrinsic.Control.If(V.Local.iCompute,<>,0)
		F.Intrinsic.Control.If(V.Local.iCnt,<>,1)
			V.Local.sDataTitles.Set("Suspects")
			V.Local.sData.Set(V.Local.iCompute)
			V.Local.iCnt.Set(1)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}*!*Suspects",V.Local.sDataTitles,V.Local.sDataTitles)
			F.Intrinsic.String.Build("{0}*!*{1}",V.Local.sData,V.Local.iCompute,V.Local.sData)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	Gui.frmCRM.gsChartOpp1.ClearChart
	F.Intrinsic.String.Build("{0}!*!{1}",V.Local.sDataTitles,V.Local.sData,V.Local.sData)
	Gui.frmCRM.gsChartOpp1.CreatePieChart("Opportunities by Type (C/P/S)","Chart1",V.Local.sData)
	Gui.frmCRM.gsChartOpp1.SetChartProperty("LEGEND","","Visible",-1,False)
	
	'Opportunities by Customer
	V.Local.sData.Set("")
	F.Data.DataView.Create("dtOppor","dvOppor")
	F.Data.DataView.ToDataTableDistinct("dtOppor","dvOppor","dtOpporCust","CompanyName",True)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtOpporCust.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.dtOpporCust(V.Local.iCnt).CompanyName!FieldValTrim,<>,"")
			V.Local.sCompany.Set(V.DataTable.dtOpporCust(V.Local.iCnt).CompanyName!FieldValTrim)
			F.Intrinsic.String.Replace(V.Local.sCompany,"'","''",V.Local.sCompany)
			F.Intrinsic.String.Build("CompanyName = '{0}'",V.Local.sCompany,V.Local.sFilter)
		F.Intrinsic.Control.Else
			V.Local.sCompany.Set("N/A")
			V.Local.sFilter.Set("CompanyName = ''")
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.Compute("dtOppor","Count(CompanyName)",V.Local.sFilter,V.Local.iCompute)
		F.Intrinsic.Control.If(V.Local.iCnt,=,0)
			V.Local.sCompanies.Set(V.Local.sCompany)
			V.Local.sData.Set(V.Local.iCompute)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}*!*{1}",V.Local.sCompanies,V.Local.sCompany,V.Local.sCompanies)
			F.Intrinsic.String.Build("{0}*!*{1}",V.Local.sData,V.Local.iCompute,V.Local.sData)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	Gui.frmCRM.gsChartOpp2.ClearChart
	F.Intrinsic.String.Build("{0}!*!{1}",V.Local.sCompanies,V.Local.sData,V.Local.sData)
	Gui.frmCRM.gsChartOpp2.CreatePieChart("Opportunities by Customer","Chart2",V.Local.sData)
	Gui.frmCRM.gsChartOpp2.SetChartProperty("LEGEND","","Visible",-1,False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadgsChartOpps.End

Program.Sub.GsGCOpp_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sParams.Declare
	V.Local.sCustomer.Declare
	V.Local.sSO.Declare
	V.Local.sQte.Declare
	V.Local.sRet.Declare
	V.Local.iRet.Declare
	V.Local.iType.Declare
	V.Local.iHandle.Declare
	V.Local.sFile.Declare

	Gui.frmCRM.GsGCOppor.GetCellValueByColumnName("gvOppor","Company",V.Args.RowIndex,V.Local.sCustomer)
	Gui.frmCRM.GsGCOppor.GetCellValueByColumnName("gvOppor","CompType",V.Args.RowIndex,V.Local.iType)
	Gui.frmCRM.GsGCOppor.GetCellValueByColumnName("gvOppor","SalesOrder",V.Args.RowIndex,V.Local.sSO)
	Gui.frmCRM.GsGCOppor.GetCellValueByColumnName("gvOppor","Quote",V.Args.RowIndex,V.Local.sQte)

	F.Intrinsic.Control.SelectCase(V.Args.Column)
			F.Intrinsic.Control.Case("CompanyName")
				F.Intrinsic.Control.If(V.Screen.frmCRM!optView.Value)
					F.Intrinsic.String.Build("MODE::9*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}",V.Local.sCustomer,V.Local.iType,V.Local.sParams)
					F.Global.CRM.Invoke(V.Local.sParams,V.Local.iHandle)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("MODE::1*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}",V.Local.sCustomer,V.Local.iType,V.Local.sParams)
					F.Global.CRM.Invoke(V.Local.sParams,V.Local.iHandle)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Case("SalesOrder")
				F.Intrinsic.Control.If(V.Screen.frmCRM!optView.Value)
					F.Intrinsic.String.Build("{0}!*!V!*!{1}",V.Local.sSO,V.Local.sCustomer,V.Local.sParams)
					F.Global.General.CallWrapperASync(200000,V.Local.sParams)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}!*!O!*!{1}",V.Local.sSO,V.Local.sCustomer,V.Local.sParams)
					F.Global.General.CallWrapperASync(200000,V.Local.sParams)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Case("Quote")
				F.Intrinsic.Control.If(V.Screen.frmCRM!optView.Value)
					F.Intrinsic.String.Build("{0}!*!V",V.Local.sQte,V.Local.sParams)
					F.Global.General.CallWrapperASync(251000,V.Local.sParams)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}!*!O",V.Local.sQte,V.Local.sParams)
					F.Global.General.CallWrapperASync(251000,V.Local.sParams)
				F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCOpp_RowCellClick.End

Program.Sub.LoadEvents.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sFilter.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtEvents.Exists)
		F.Data.DataTable.Close("dtEvents")
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.OpenCompanyConnection(300)
	
	F.Intrinsic.Control.SelectCase(V.Screen.frmCRM!ddlOpts.Text)
		F.Intrinsic.Control.Case("All Data")
			F.Data.DataTable.CreateFromSQL("dtEvents0","con","Select CompID As Company,Case CompType When 15 Then B.Name_Customer When 18 Then C.Name_Prospect When 19 Then C.Name_Prospect When 10 Then D.Name_Vendor End As CompanyName,Case CompType When 15 Then 'C' When 18 Then 'P' When 19 Then 'S' When 10 Then 'V' End As CPSV,Title As Title,E.Value As Type,Rcpt As Recipient,F.Value As Status,If(Close_DateTime Is Null,'Open','Closed') As Open_Closed,Case Priority When 0 Then '0- Low' When 1 Then '1- Med.' When 2 Then '2- High' End As Priority,Close_DateTime,Start_DateTime,End_DateTime,Description,CompType From CRM_EVENTS A Left Join V_CUSTOMER_MASTER B ON A.CompID = B.Customer Left Join PROSPECT_MASTER C ON A.CompID = C.Prospect Left Join V_VENDOR_MASTER D ON A.CompID = D.Vendor Left Join CRM_EVENT_TYPE E ON A.ETYPE = E.SEQ Left Join CRM_EVENT_STATUS F ON A.Status = F.Seq Where CompID <> '' Order By CompID;",True)
			V.Local.sFilter.Set("")
			F.Intrinsic.Control.If(V.Global.bAdmin,=,False)
				F.Intrinsic.String.Build("Company In ({0})",V.Global.sCustomers,V.Local.sFilter)
			F.Intrinsic.Control.EndIf
			F.Data.DataView.Create("dtEvents0","dvEvents0",22,V.Local.sFilter,"")
			F.Data.DataView.ToDataTable("dtEvents0","dvEvents0","dtEvents",True)
			F.Data.DataTable.Close("dtEvents0")
		F.Intrinsic.Control.CaseAny("Salesperson","Customer","Contact","Part")
			F.Intrinsic.String.Build("Select CompID As Company,Case CompType When 15 Then B.Name_Customer When 18 Then C.Name_Prospect When 19 Then C.Name_Prospect When 10 Then D.Name_Vendor End As CompanyName,Case CompType When 15 Then 'C' When 18 Then 'P' When 19 Then 'S' When 10 Then 'V' End As CPSV,Title As Title,E.Value As Type,Rcpt As Recipient,F.Value As Status,If(Close_DateTime Is Null,'Open','Closed') As Open_Closed,Case Priority When 0 Then '0- Low' When 1 Then '1- Med.' When 2 Then '2- High' End As Priority,Close_DateTime,Start_DateTime,End_DateTime,Description,CompType From CRM_EVENTS A Left Join V_CUSTOMER_MASTER B ON A.CompID = B.Customer Left Join PROSPECT_MASTER C ON A.CompID = C.Prospect Left Join V_VENDOR_MASTER D ON A.CompID = D.Vendor Left Join CRM_EVENT_TYPE E ON A.ETYPE = E.SEQ Left Join CRM_EVENT_STATUS F ON A.Status = F.Seq Where CompID <> '' And CompID In ({0}) Order By CompID;",V.Global.sCustomers,V.Local.sSQL)
			F.Data.DataTable.CreateFromSQL("dtEvents","con",V.Local.sSQL,True)
	F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.CallSub(LoadGvEvents)
	
	F.ODBC.Connection!con.Close
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadEvents.End

Program.Sub.LoadGvEvents.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmCRM.GsGCEvents.AddGridViewFromDataTable("gvEvents","dtEvents")
	Gui.frmCRM.GsGCEvents.SuspendLayout()
	Gui.frmCRM.GsGCEvents.SetGridViewProperty("gvEvents","MultiSelect",True)
	Gui.frmCRM.GsGCEvents.SetGridViewProperty("gvEvents","AllowSort",True)
	Gui.frmCRM.GsGCEvents.SetGridViewProperty("gvEvents","AllowFilter",True)
	Gui.frmCRM.GsGCEvents.SetGridViewProperty("gvEvents","Editable",False)
	Gui.frmCRM.GsGCEvents.SetGridViewProperty("gvEvents","ShowGroupPanel",True)
	Gui.frmCRM.GsGCEvents.SetGridViewProperty("gvEvents","EnableAppearanceOddRow",True)

	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","CompType","Visible",False)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Company","Visible",False)

	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Company","Caption","Number")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","CompanyName","Caption","Name")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","CPSV","Caption","C/P/S/V")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Title","Caption","Title ")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Type","Caption","Type")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Recipient","Caption","Recipient")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Status","Caption","Status")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Open_Closed","Caption","Open/Closed")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Priority","Caption","Priority")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Close_DateTime","Caption","Closed Date")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Start_DateTime","Caption","Start Date")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","End_DateTime","Caption","End Date")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Description","Caption","Description")

	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","CompanyName","CellForeColor","Blue")

	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Company","MinWidth","35")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","CompanyName","MinWidth","200")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","CPSV","MinWidth","55")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Title","MinWidth","150")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Type","MinWidth","100")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Recipient","MinWidth","100")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Status","MinWidth","100")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Open_Closed","MinWidth","75")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Priority","MinWidth","50")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Close_DateTime","MinWidth","80")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Start_DateTime","MinWidth","80")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","End_DateTime","MinWidth","80")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Description","MinWidth","400")

	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Company","Fixed","Left")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","CompanyName","Fixed","Left")

	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Company","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","CompanyName","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","CPSV","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Title","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Type","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Recipient","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Status","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Open_Closed","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Priority","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Close_DateTime","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Start_DateTime","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","End_DateTime","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Description","HeaderHAlignment","Center")
	
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Company","HeaderFontBold",True)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","CompanyName","HeaderFontBold",True)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","CPSV","HeaderFontBold",True)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Title","HeaderFontBold",True)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Type","HeaderFontBold",True)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Recipient","HeaderFontBold",True)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Status","HeaderFontBold",True)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Open_Closed","HeaderFontBold",True)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Priority","HeaderFontBold",True)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Close_DateTime","HeaderFontBold",True)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Start_DateTime","HeaderFontBold",True)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","End_DateTime","HeaderFontBold",True)
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Description","HeaderFontBold",True)

	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Company","CellHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","CPSV","CellHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Recipient","CellHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Open_Closed","CellHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Priority","CellHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Close_DateTime","CellHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Start_DateTime","CellHAlignment","Center")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","End_DateTime","CellHAlignment","Center")

	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Close_DateTime","DisplayCustomDatetime","d")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","Start_DateTime","DisplayCustomDatetime","d")
	Gui.frmCRM.GsGCEvents.SetColumnProperty("gvEvents","End_DateTime","DisplayCustomDatetime","d")
	
	Gui.frmCRM.GsGCEvents.ResumeLayout()
	Gui.frmCRM.GsGCEvents.MainView("gvEvents")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGvEvents.End

Program.Sub.GsGCEvents_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sParams.Declare
	V.Local.sCustomer.Declare
	V.Local.iType.Declare
	V.Local.iHandle.Declare

	Gui.frmCRM.GsGCEvents.GetCellValueByColumnName("gvEvents","Company",V.Args.RowIndex,V.Local.sCustomer)
	Gui.frmCRM.GsGCEvents.GetCellValueByColumnName("gvEvents","CompType",V.Args.RowIndex,V.Local.iType)

	F.Intrinsic.Control.If(V.Args.Column,=,"CompanyName")
		F.Intrinsic.Control.If(V.Screen.frmCRM!optView.Value,=,True)
			F.Intrinsic.String.Build("MODE::9*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}",V.Local.sCustomer,V.Local.iType,V.Local.sParams)
			F.Global.CRM.Invoke(V.Local.sParams,V.Local.iHandle)	
		F.Intrinsic.Control.ElseIf(V.Screen.frmCRM!optView.Value,=,False)
			F.Intrinsic.String.Build("MODE::1*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}",V.Local.sCustomer,V.Local.iType,V.Local.sParams)
			F.Global.CRM.Invoke(V.Local.sParams,V.Local.iHandle)	
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCEvents_RowCellClick.End

Program.Sub.LoadNotes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sFilter.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtNotes.Exists)
		F.Data.DataTable.Close("dtNotes")
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.OpenCompanyConnection(300)
	
	F.Intrinsic.Control.SelectCase(V.Screen.frmCRM!ddlOpts.Text)
		F.Intrinsic.Control.Case("All Data")
			F.Data.DataTable.CreateFromSQL("dtNotes0","con","SELECT COMPID As Company,CASE WHEN COMPTYPE = 15 THEN VCM.NAME_CUSTOMER WHEN COMPTYPE = 18 THEN PM.NAME_PROSPECT WHEN COMPTYPE = 19 THEN PM.NAME_PROSPECT WHEN COMPTYPE = 10 THEN VVM.NAME_VENDOR END As CompanyName,CASE WHEN COMPTYPE = 15 THEN 'C' WHEN COMPTYPE = 18 THEN 'P' WHEN COMPTYPE = 19 THEN 'S' WHEN COMPTYPE = 10 THEN 'V' END As CPSV,CASE WHEN NTYPE = 0 THEN 'Main' WHEN NTYPE = 1 THEN 'Contact' WHEN NTYPE = 2 THEN 'Opportunity' END As Type,'' AS Contact,CNC.NOTES,CNC.LAST_CHG_BY,CNC.LAST_CHG_DATETIME,COMPTYPE FROM CRM_NOTES_COMBINED CNC LEFT JOIN V_CUSTOMER_MASTER VCM ON CNC.COMPID = VCM.CUSTOMER LEFT JOIN PROSPECT_MASTER PM ON CNC.COMPID = PM.PROSPECT LEFT JOIN V_VENDOR_MASTER VVM ON CNC.COMPID = VVM.VENDOR WHERE CNC.COMPID <> '' ORDER BY COMPID;",True)
			V.Local.sFilter.Set("")
			F.Intrinsic.Control.If(V.Global.bAdmin,=,False)
				F.Intrinsic.String.Build("Company In ({0})",V.Global.sCustomers,V.Local.sFilter)
			F.Intrinsic.Control.EndIf
			F.Data.DataView.Create("dtNotes0","dvNotes0",22,V.Local.sFilter,"")
			F.Data.DataView.ToDataTable("dtNotes0","dvNotes0","dtNotes",True)
			F.Data.DataTable.Close("dtNotes0")
		F.Intrinsic.Control.CaseAny("Salesperson","Customer","Contact","Part")
			F.Intrinsic.String.Build("SELECT COMPID As Company,CASE WHEN COMPTYPE = 15 THEN VCM.NAME_CUSTOMER WHEN COMPTYPE = 18 THEN PM.NAME_PROSPECT WHEN COMPTYPE = 19 THEN PM.NAME_PROSPECT WHEN COMPTYPE = 10 THEN VVM.NAME_VENDOR END As CompanyName,CASE WHEN COMPTYPE = 15 THEN 'C' WHEN COMPTYPE = 18 THEN 'P' WHEN COMPTYPE = 19 THEN 'S' WHEN COMPTYPE = 10 THEN 'V' END As CPSV,CASE WHEN NTYPE = 0 THEN 'Main' WHEN NTYPE = 1 THEN 'Contact' WHEN NTYPE = 2 THEN 'Opportunity' END As Type,'' AS Contact,CNC.NOTES,CNC.LAST_CHG_BY,CNC.LAST_CHG_DATETIME,COMPTYPE FROM CRM_NOTES_COMBINED CNC LEFT JOIN V_CUSTOMER_MASTER VCM ON CNC.COMPID = VCM.CUSTOMER LEFT JOIN PROSPECT_MASTER PM ON CNC.COMPID = PM.PROSPECT LEFT JOIN V_VENDOR_MASTER VVM ON CNC.COMPID = VVM.VENDOR WHERE CNC.COMPID <> '' And CompID In ({0}) ORDER BY COMPID;",V.Global.sCustomers,V.Local.sSQL)
			F.Data.DataTable.CreateFromSQL("dtNotes","con",V.Local.sSQL,True)
	F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.CallSub(LoadGvNotes)
	
	F.ODBC.Connection!con.Close
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadNotes.End

Program.Sub.LoadGvNotes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmCRM.GsGCNotes.AddGridViewFromDataTable("gvNotes","dtNotes")
	Gui.frmCRM.GsGCNotes.SuspendLayout()
	Gui.frmCRM.GsGCNotes.SetGridViewProperty("gvNotes","MultiSelect",True)
	Gui.frmCRM.GsGCNotes.SetGridViewProperty("gvNotes","AllowSort",True)
	Gui.frmCRM.GsGCNotes.SetGridViewProperty("gvNotes","AllowFilter",True)
	Gui.frmCRM.GsGCNotes.SetGridViewProperty("gvNotes","Editable",False)
	Gui.frmCRM.GsGCNotes.SetGridViewProperty("gvNotes","ShowGroupPanel",True)
	Gui.frmCRM.GsGCNotes.SetGridViewProperty("gvNotes","EnableAppearanceOddRow",True)

	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CompType","Visible",False)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Company","Visible",False)

	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Company","Caption","Number")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CompanyName","Caption","Name")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CPSV","Caption","C/P/S/V")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Type","Caption","Type")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Contact","Caption","Contact")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Notes","Caption","Notes ")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","LAST_CHG_BY","Caption","Last Change By")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Last_Chg_DateTime","Caption","Last Change Date")

	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CompanyName","CellForeColor","Blue")
	
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Company","AllowEdit",False)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CompanyName","AllowEdit",False)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CPSV","AllowEdit",False)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Type","AllowEdit",False)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Contact","AllowEdit",False)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Notes","AllowEdit",True)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","LAST_CHG_BY","AllowEdit",False)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Last_Chg_DateTime","AllowEdit",False)
	
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Notes","ReadOnly",True)

	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Company","MinWidth","35")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CompanyName","MinWidth","200")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CPSV","MinWidth","55")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Type","MinWidth","50")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Contact","MinWidth","150")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Notes","MinWidth","900")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","LAST_CHG_BY","MinWidth","100")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Last_Chg_DateTime","MinWidth","105")

	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Company","Fixed","Left")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CompanyName","Fixed","Left")

	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Company","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CompanyName","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CPSV","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Type","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Contact","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","LAST_CHG_BY","HeaderHAlignment","Center")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Last_Chg_DateTime","HeaderHAlignment","Center")
	
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Company","HeaderFontBold",True)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CompanyName","HeaderFontBold",True)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CPSV","HeaderFontBold",True)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Type","HeaderFontBold",True)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Contact","HeaderFontBold",True)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Notes","HeaderFontBold",True)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","LAST_CHG_BY","HeaderFontBold",True)
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Last_Chg_DateTime","HeaderFontBold",True)

	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Company","CellHAlignment","Center")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CompanyName","CellHAlignment","Center")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","CPSV","CellHAlignment","Center")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Type","CellHAlignment","Center")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Contact","CellHAlignment","Center")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","LAST_CHG_BY","CellHAlignment","Center")
	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Last_Chg_DateTime","CellHAlignment","Center")

	Gui.frmCRM.GsGCNotes.SetColumnProperty("gvNotes","Last_Chg_DateTime","DisplayCustomDatetime","d")
	
	Gui.frmCRM.GsGCNotes.ResumeLayout()
	Gui.frmCRM.GsGCNotes.MainView("gvNotes")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGvNotes.End

Program.Sub.GsGCNotes_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sParams.Declare
	V.Local.sCustomer.Declare
	V.Local.iType.Declare
	V.Local.iHandle.Declare

	Gui.frmCRM.GsGCNotes.GetCellValueByColumnName("gvNotes","Company",V.Args.RowIndex,V.Local.sCustomer)
	Gui.frmCRM.GsGCNotes.GetCellValueByColumnName("gvNotes","CompType",V.Args.RowIndex,V.Local.iType)
		F.Intrinsic.Control.If(V.Args.Column,=,"CompanyName")
		F.Intrinsic.Control.If(V.Screen.frmCRM!optView.Value)
			F.Intrinsic.String.Build("MODE::9*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}",V.Local.sCustomer,V.Local.iType,V.Local.sParams)
			F.Global.CRM.Invoke(V.Local.sParams,V.Local.iHandle)	
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("MODE::1*!*COMPANY-NUMBER::{0}*!*COMPANY-TYPE::{1}",V.Local.sCustomer,V.Local.iType,V.Local.sParams)
			F.Global.CRM.Invoke(V.Local.sParams,V.Local.iHandle)	
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCNotes_RowCellClick.End

Program.Sub.Serialize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare
	
	Gui.frmCRM.GsGCSalesHist.Serialize("gvSalesHist",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVSALESHIST",6572,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	
	Gui.frmCRM.GsGCSalesOrders.Serialize("gvSalesOrders",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVSALESORDERS",6572,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	
	Gui.frmCRM.GsGCQuotes.Serialize("gvQuotes",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVQUOTES",6572,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	
	Gui.frmCRM.GsGCOppor.Serialize("gvOppor",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVOPPOR",6572,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	
	Gui.frmCRM.GsGCEvents.Serialize("gvEvents",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVEVENTS",6572,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	
	Gui.frmCRM.GsGCNotes.Serialize("gvNotes",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVNOTES",6572,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Serialize.End

Program.Sub.Deserialize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare
	
	'GvSalesHistSerialize
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVSALESHIST",6572,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
		Gui.frmCRM.GsGCSalesHist.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvSalesOrdersSerialize
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVSALESORDERS",6572,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
		Gui.frmCRM.GsGCSalesOrders.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvQuotesSerialize
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVQUOTES",6572,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
		Gui.frmCRM.GsGCQuotes.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvOpporSerialize
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVOPPOR",6572,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
		Gui.frmCRM.GsGCOppor.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvEventsSerialize
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVEVENTS",6572,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
		Gui.frmCRM.GsGCEvents.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	'GvNotesSerialize
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVNOTES",6572,1000,6,"",V.Local.sSerialize)
	F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
		Gui.frmCRM.GsGCNotes.Deserialize(V.Local.sSerialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Deserialize.End

Program.Sub.picGSSLogo_DblClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmWeb..Show
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.picGSSLogo_DblClick.End

Program.Sub.frmWeb_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmWeb..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.frmWeb_UnLoad.End

Program.Sub.cmdGSS_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Task.ShellExec(0,"Open","http://www.globalshopsolutions.com/","","",0)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cmdGSS_Click.End

Program.Sub.cmdServ_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Task.ShellExec(0,"Open","http://gss-service.com/","","",0)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cmdServ_Click.End

Program.Sub.cmdUpd_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Task.ShellExec(0,"Open","http://gss-updates.com/","","",0)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.cmdUpd_Click.End

Program.Sub.SetContextMenus.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmCRM..ContextMenuCreate("ctxSalesHist")
	Gui.frmCRM.GsGCSalesHist.ContextMenuAttach("ctxSalesHist")
	Gui.frmCRM..ContextMenuAddItem("ctxSalesHist","Refresh",0,"Refresh")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxSalesHist","Refresh","MenuClickRefresh")
	Gui.frmCRM..ContextMenuAddItem("ctxSalesHist","Export",0,"Export")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxSalesHist","Export","MenuClickExport")
	Gui.frmCRM..ContextMenuAddItem("ctxSalesHist","RefreshAll",0,"Refresh All")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxSalesHist","RefreshAll","MenuClickRefreshAll")
	Gui.frmCRM..ContextMenuAddItem("ctxSalesHist","ResetColumns",0,"Reset Columns")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxSalesHist","ResetColumns","MenuClickResetColumns")
	
	Gui.frmCRM..ContextMenuCreate("ctxSalesOrders")
	Gui.frmCRM.GsGCSalesOrders.ContextMenuAttach("ctxSalesOrders")
	Gui.frmCRM..ContextMenuAddItem("ctxSalesOrders","Refresh",0,"Refresh")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxSalesOrders","Refresh","MenuClickRefresh")
	Gui.frmCRM..ContextMenuAddItem("ctxSalesOrders","Export",0,"Export")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxSalesOrders","Export","MenuClickExport")
	Gui.frmCRM..ContextMenuAddItem("ctxSalesOrders","RefreshAll",0,"Refresh All")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxSalesOrders","RefreshAll","MenuClickRefreshAll")
	Gui.frmCRM..ContextMenuAddItem("ctxSalesOrders","ResetColumns",0,"Reset Columns")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxSalesOrders","ResetColumns","MenuClickResetColumns")
	
	Gui.frmCRM..ContextMenuCreate("ctxQuotes")
	Gui.frmCRM.GsGCQuotes.ContextMenuAttach("ctxQuotes")
	Gui.frmCRM..ContextMenuAddItem("ctxQuotes","Refresh",0,"Refresh")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxQuotes","Refresh","MenuClickRefresh")
	Gui.frmCRM..ContextMenuAddItem("ctxQuotes","Export",0,"Export")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxQuotes","Export","MenuClickExport")
	Gui.frmCRM..ContextMenuAddItem("ctxQuotes","RefreshAll",0,"Refresh All")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxQuotes","RefreshAll","MenuClickRefreshAll")
	Gui.frmCRM..ContextMenuAddItem("ctxQuotes","ResetColumns",0,"Reset Columns")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxQuotes","ResetColumns","MenuClickResetColumns")
	
	Gui.frmCRM..ContextMenuCreate("ctxOppor")
	Gui.frmCRM.GsGCOppor.ContextMenuAttach("ctxOppor")
	Gui.frmCRM..ContextMenuAddItem("ctxOppor","Refresh",0,"Refresh")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxOppor","Refresh","MenuClickRefresh")
	Gui.frmCRM..ContextMenuAddItem("ctxOppor","Export",0,"Export")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxOppor","Export","MenuClickExport")
	Gui.frmCRM..ContextMenuAddItem("ctxOppor","RefreshAll",0,"Refresh All")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxOppor","RefreshAll","MenuClickRefreshAll")
	Gui.frmCRM..ContextMenuAddItem("ctxOppor","ResetColumns",0,"Reset Columns")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxOppor","ResetColumns","MenuClickResetColumns")
	
	Gui.frmCRM..ContextMenuCreate("ctxEvents")
	Gui.frmCRM.GsGCEvents.ContextMenuAttach("ctxEvents")
	Gui.frmCRM..ContextMenuAddItem("ctxEvents","Refresh",0,"Refresh")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxEvents","Refresh","MenuClickRefresh")
	Gui.frmCRM..ContextMenuAddItem("ctxEvents","Export",0,"Export")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxEvents","Export","MenuClickExport")
	Gui.frmCRM..ContextMenuAddItem("ctxEvents","RefreshAll",0,"Refresh All")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxEvents","RefreshAll","MenuClickRefreshAll")
	Gui.frmCRM..ContextMenuAddItem("ctxEvents","ResetColumns",0,"Reset Columns")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxEvents","ResetColumns","MenuClickResetColumns")
	
	Gui.frmCRM..ContextMenuCreate("ctxNotes")
	Gui.frmCRM.GsGCNotes.ContextMenuAttach("ctxNotes")
	Gui.frmCRM..ContextMenuAddItem("ctxNotes","Refresh",0,"Refresh")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxNotes","Refresh","MenuClickRefresh")
	Gui.frmCRM..ContextMenuAddItem("ctxNotes","Export",0,"Export")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxNotes","Export","MenuClickExport")
	Gui.frmCRM..ContextMenuAddItem("ctxNotes","RefreshAll",0,"Refresh All")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxNotes","RefreshAll","MenuClickRefreshAll")
	Gui.frmCRM..ContextMenuAddItem("ctxNotes","ResetColumns",0,"Reset Columns")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxNotes","ResetColumns","MenuClickResetColumns")
	
	Gui.frmCRM..ContextMenuCreate("ctxChartOpp1")
	Gui.frmCRM.gsChartOpp1.ContextMenuAttach("ctxChartOpp1")
	Gui.frmCRM..ContextMenuAddItem("ctxChartOpp1","Export",0,"Export")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxChartOpp1","Export","MenuClickExport")
	
	Gui.frmCRM..ContextMenuCreate("ctxChartOpp2")
	Gui.frmCRM.gsChartOpp2.ContextMenuAttach("ctxChartOpp2")
	Gui.frmCRM..ContextMenuAddItem("ctxChartOpp2","Export",0,"Export")
	Gui.frmCRM..ContextMenuSetItemEventHandler("ctxChartOpp2","Export","MenuClickExport")
	
	Gui.frmNotes..ContextMenuCreate("ctxSHNotes")
	Gui.frmNotes.GsGCNotes.ContextMenuAttach("ctxSHNotes")
	Gui.frmNotes..ContextMenuAddItem("ctxSHNotes","AddNote",0,"Add Note")
	Gui.frmNotes..ContextMenuSetItemEventHandler("ctxSHNotes","AddNote","MenuClickAdd")
	Gui.frmNotes..ContextMenuAddItem("ctxSHNotes","DelNote",0,"Delete Note")
	Gui.frmNotes..ContextMenuSetItemEventHandler("ctxSHNotes","DelNote","MenuClickDelete")
	Gui.frmNotes..ContextMenuAddItem("ctxSHNotes","Refresh",0,"Refresh")
	Gui.frmNotes..ContextMenuSetItemEventHandler("ctxSHNotes","Refresh","MenuClickRefresh")
	Gui.frmNotes..ContextMenuAddItem("ctxSHNotes","Export",0,"Export")
	Gui.frmNotes..ContextMenuSetItemEventHandler("ctxSHNotes","Export","MenuClickExport")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetContextMenus.End

Program.Sub.MenuClickRefresh.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.SelectCase(V.Args.MenuName)
		F.Intrinsic.Control.Case("CTXSALESHIST")
			Gui.frmCRM.lblStatus.Visible(True)
			Gui.frmCRM.lblStatus.Caption("Loading Sales History....")
			F.Intrinsic.Control.CallSub(LoadSalesHistory)
			Gui.frmCRM.lblStatus.Caption("Retrieving Customer Informaiton....")
			F.Intrinsic.Control.CallSub(GetDistinctCustomers)
			Gui.frmCRM.lblStatus.Caption("Loading Customer Information....")
			F.Intrinsic.Control.CallSub(LoadAddlCustInfo)
			F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVSALESHIST",6572,1000,6,"",V.Local.sSerialize)
			F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
				Gui.frmCRM.GsGCSalesHist.Deserialize(V.Local.sSerialize)
			F.Intrinsic.Control.EndIf
			Gui.frmCRM.lblStatus.Visible(False)
			
		F.Intrinsic.Control.Case("CTXSALESORDERS")
			Gui.frmCRM.lblStatus.Visible(True)
			Gui.frmCRM.lblStatus.Caption("Loading Sales Orders....")
			F.Intrinsic.Control.CallSub(LoadSalesOrders)
			F.Intrinsic.File.Exists(V.Global.sGvSalesOrdersSerialize,V.Local.bFile)
			F.Intrinsic.Control.If(V.Local.bFile)
				F.Intrinsic.File.File2String(V.Global.sGvSalesOrdersSerialize,V.Local.sSerialize)
				Gui.frmCRM.GsGCSalesOrders.Deserialize(V.Local.sSerialize)
			F.Intrinsic.Control.EndIf
			Gui.frmCRM.lblStatus.Visible(False)
			
		F.Intrinsic.Control.Case("CTXQUOTES")
			Gui.frmCRM.lblStatus.Visible(True)
			Gui.frmCRM.lblStatus.Caption("Loading Quotes....")
			F.Intrinsic.Control.CallSub(LoadQuotes)
			F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVQUOTES",6572,1000,6,"",V.Local.sSerialize)
			F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
				Gui.frmCRM.GsGCQuotes.Deserialize(V.Local.sSerialize)
			F.Intrinsic.Control.EndIf
			Gui.frmCRM.lblStatus.Visible(False)
			
		F.Intrinsic.Control.CaseAny("CTXOPPOR")
			Gui.frmCRM.lblStatus.Visible(True)
			Gui.frmCRM.lblStatus.Caption("Loading CRM Opportunities....")
			F.Intrinsic.Control.CallSub(GetDistinctCustomers)
			F.Intrinsic.Control.CallSub(LoadOppor)
			F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVOPPOR",6572,1000,6,"",V.Local.sSerialize)
			F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
				Gui.frmCRM.GsGCOppor.Deserialize(V.Local.sSerialize)
			F.Intrinsic.Control.EndIf
			Gui.frmCRM.lblStatus.Visible(False)
			
		F.Intrinsic.Control.Case("CTXEVENTS")
			Gui.frmCRM.lblStatus.Visible(True)
			Gui.frmCRM.lblStatus.Caption("Loading CRM Events....")
			F.Intrinsic.Control.CallSub(GetDistinctCustomers)
			F.Intrinsic.Control.CallSub(LoadEvents)
			F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVEVENTS",6572,1000,6,"",V.Local.sSerialize)
			F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
				Gui.frmCRM.GsGCEvents.Deserialize(V.Local.sSerialize)
			F.Intrinsic.Control.EndIf
			Gui.frmCRM.lblStatus.Visible(False)
			
		F.Intrinsic.Control.Case("CTXNOTES")
			Gui.frmCRM.lblStatus.Visible(True)
			Gui.frmCRM.lblStatus.Caption("Loading CRM Notes....")
			F.Intrinsic.Control.CallSub(GetDistinctCustomers)
			F.Intrinsic.Control.CallSub(LoadNotes)
			F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVNOTES",6572,1000,6,"",V.Local.sSerialize)
			F.Intrinsic.Control.If(V.Local.sSerialize,<>,"")
				Gui.frmCRM.GsGCNotes.Deserialize(V.Local.sSerialize)
			F.Intrinsic.Control.EndIf
			Gui.frmCRM.lblStatus.Visible(False)
			
		F.Intrinsic.Control.Case("CTXSHNOTES")
			F.Intrinsic.Control.CallSub(LoadDtSHNotes)
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.CallSub(Deserialize)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickRefresh.End

Program.Sub.MenuClickRefreshAll.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.CallSub(LoadData)
	
	F.Intrinsic.Control.CallSub(Deserialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickRefreshAll.End

Program.Sub.MenuClickExport.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFileExport.Declare
	V.Local.bExcel.Declare
	V.Local.bFileLocked.Declare
	V.Local.sMsg.Declare
	V.Local.iRet.Declare
	V.Local.sForm.Declare(String,"FRMCRM")
	V.Local.sControl.Declare
	V.Local.bChart.Declare

	V.Local.bChart.Set(False)
	F.Intrinsic.Control.SelectCase(V.Args.MenuName)
		F.Intrinsic.Control.Case("CTXSALESHIST")
			V.Local.sControl.Set("GsGCSalesHist")
		F.Intrinsic.Control.Case("CTXSALESORDERS")
			V.Local.sControl.Set("GsGCSalesOrders")
		F.Intrinsic.Control.Case("CTXQUOTES")
			V.Local.sControl.Set("GsGCQuotes")
		F.Intrinsic.Control.Case("CTXOPPOR")
			V.Local.sControl.Set("GsGCOppor")
		F.Intrinsic.Control.Case("CTXEVENTS")
			V.Local.sControl.Set("GsGCEvents")
		F.Intrinsic.Control.Case("CTXNOTES")
			V.Local.sControl.Set("GsGCNotes")
		F.Intrinsic.Control.Case("CTXCHARTOPP1")
			V.Local.bChart.Set(True)
			V.Local.sControl.Set("gsChartOpp1")
		F.Intrinsic.Control.Case("CTXCHARTOPP2")
			V.Local.bChart.Set(True)
			V.Local.sControl.Set("gsChartOpp2")
		F.Intrinsic.Control.Case("CTXSHNOTES")
			V.Local.sForm.Set("FRMNOTES")
			V.Local.sControl.Set("GsGCNotes")
	F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.If(V.Local.bChart,=,False)
		F.Automation.MSExcel.CheckPresence(V.Local.bExcel)
		F.Intrinsic.Control.If(V.Local.bExcel)
			F.Intrinsic.String.Build("{0}\GAB_{1}_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sControl,V.Local.sFileExport)
			F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
			F.Intrinsic.Control.If(V.Local.bFileLocked)
				F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
				F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
			F.Intrinsic.Control.Else
				Gui.[V.Local.sForm].[V.Local.sControl].Export(V.Local.sFileExport,"xlsx")
				F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}\GAB_{1}_Export.csv",V.Caller.LocalGssTempDir,V.Local.sControl,V.Local.sFileExport)
			F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
			F.Intrinsic.Control.If(V.Local.bFileLocked)
				F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
				F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
			F.Intrinsic.Control.Else
				Gui.[V.Local.sForm].[V.Local.sControl].Export(V.Local.sFileExport,"csv")
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}\{1}.jpg",V.Caller.LocalGSSTempDir,V.Local.sControl,V.Local.sFileExport)
		Gui.[V.Local.sForm].[V.Local.sControl].ImageToFile("JPEG",V.Local.sFileExport)
		F.Intrinsic.Task.ShellExec(0,"Open",V.Local.sFileExport,"","",0)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickExport.End

Program.Sub.MenuClickAdd.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iNID.Declare
	
	F.ODBC.Connection!con.OpenCompanyConnection(300)
	F.ODBC.Connection!con.ExecuteAndReturn("Select Max(NID) From GAB_6572_NOTES;",V.Local.iNID)
	F.Intrinsic.Math.Add(V.Local.iNID,1,V.Local.iNID)
	F.Data.DataTable.AddRow("dtSHNotes","NID",V.Local.iNID,"Salesperson",V.Global.sNTSaleperson,"Customer",V.Global.sNTCustomer,"Part",V.Global.sNTPart,"GSUSER",V.Caller.User,"CREATE_DT",V.Ambient.Date,"CREATE_TIME",V.Ambient.Time.FormatHh:Nn:Ss)
	F.Data.DataTable.SaveToDB("dtSHNotes","con","GAB_6572_NOTES","NID")
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.CallSub(LoadDtSHNotes)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickAdd.End

Program.Sub.MenuClickDelete.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRow.Declare
	V.Local.sSQL.Declare
	
	F.ODBC.Connection!con.OpenCompanyConnection(300)
	Gui.frmNotes.GsGCNotes.GetSelectedRows("gvSHNotes",V.Local.iRow)
	F.Intrinsic.String.Build("Delete From GAB_6572_NOTES Where NID = {0};",V.DataTable.dtSHNotes(V.Local.iRow).NID!FieldVal,V.Local.sSQL)
	F.ODBC.Connection!con.Execute(V.Local.sSQL)
	F.Data.DataTable.DeleteRow("dtSHNotes",V.Local.iRow)
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.CallSub(LoadDtSHNotes)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickDelete.End

Program.Sub.MenuClickResetColumns.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.SelectCase(V.Args.MenuName)
		F.Intrinsic.Control.Case("CTXSALESHIST")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVSALESHIST",6572,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
			F.Intrinsic.Control.CallSub(LoadSalesHistory)
			F.Intrinsic.Control.CallSub(LoadQuotes)
			F.Intrinsic.Control.CallSub(GetDistinctCustomers)
			F.Intrinsic.Control.CallSub(LoadAddlCustInfo)
			Gui.frmCRM.tabCRM.SetTab(1)
			Gui.frmCRM.tabCRM.SetTab(0)
		F.Intrinsic.Control.Case("CTXSALESORDERS")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVSALESORDERS",6572,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
			F.Intrinsic.Control.CallSub(LoadSalesOrders)
		F.Intrinsic.Control.Case("CTXQUOTES")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVQUOTES",6572,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
			F.Intrinsic.Control.CallSub(LoadQuotes)
		F.Intrinsic.Control.CaseAny("CTXOPPOR")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVOPPOR",6572,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
			F.Intrinsic.Control.CallSub(GetDistinctCustomers)
			F.Intrinsic.Control.CallSub(LoadOppor)
		F.Intrinsic.Control.Case("CTXEVENTS")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVEVENTS",6572,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
			F.Intrinsic.Control.CallSub(GetDistinctCustomers)
			F.Intrinsic.Control.CallSub(LoadEvents)
		F.Intrinsic.Control.Case("CTXNOTES")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"CRMGVNOTES",6572,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
			F.Intrinsic.Control.CallSub(GetDistinctCustomers)
			F.Intrinsic.Control.CallSub(LoadNotes)
		F.Intrinsic.Control.Case("CTXSHNOTES")
			F.Intrinsic.Control.CallSub(LoadDtSHNotes)
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickResetColumns.End

Program.Sub.LoadDtSHNotes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare

	F.Intrinsic.Control.If(V.DataTable.dtSHNotes.Exists)
		F.Data.DataTable.Close("dtSHNotes")
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.OpenCompanyConnection(300)
	
	F.Intrinsic.String.Build("Select * From GAB_6572_NOTES Where Salesperson = '{0}' And Customer = '{1}' And Part = '{2}' Order By Create_Dt Desc, Create_Time Desc;",V.Global.sNTSaleperson,V.Global.sNTCustomer,V.Global.sNTPart,V.Local.sSQL)
	F.Data.DataTable.CreateFromSQL("dtSHNotes","con",V.Local.sSQL,True)
	
	F.ODBC.Connection!con.Close

	F.Intrinsic.Control.CallSub(LoadGvSHNotes)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDtSHNotes.End

Program.Sub.LoadGvSHNotes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmNotes.GsGCNotes.AddGridViewFromDataTable("gvSHNotes","dtSHNotes")
	Gui.frmNotes.GsGCNotes.MainView("gvSHNotes")
	Gui.frmNotes.GsGCNotes.SuspendLayout()
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvSHNotes","MultiSelect",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvSHNotes","OptionBehaviorEditable",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvSHNotes","AllowSort",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvSHNotes","AllowFilter",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvSHNotes","OptionsDetailShowDetailTabs",False)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvSHNotes","OptionsViewShowGroupPanel",True)
	Gui.frmNotes.GsGCNotes.SetGridViewProperty("gvSHNotes","EnableAppearanceOddRow",True)
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","NID","Visible",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Salesperson","Visible",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Customer","Visible",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Part","Visible",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Loc","Visible",False)

	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Salesperson","Caption","Salesperson")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Customer","Caption","Customer")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Part","Caption","Part")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","GSUSER","Caption","User")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","CREATE_DT","Caption","Create Date")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","CREATE_TIME","Caption","Create Time")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","NOTES","Caption","Notes")
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Salesperson","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Customer","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Part","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","GSUSER","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","CREATE_DT","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","CREATE_TIME","AllowEdit",False)
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","NOTES","AllowEdit",True)
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","NOTES","ReadOnly",False)

	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Salesperson","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Customer","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Part","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","GSUSER","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","CREATE_DT","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","CREATE_TIME","MinWidth","50")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","NOTES","MinWidth","350")
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Salesperson","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Customer","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Part","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","GSUSER","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","CREATE_DT","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","CREATE_TIME","HeaderHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","NOTES","HeaderHAlignment","Center")
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Salesperson","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Customer","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","Part","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","GSUSER","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","CREATE_DT","CellHAlignment","Center")
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","CREATE_TIME","CellHAlignment","Center")
	
	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","NOTES","CellBackColor","LightYellow")

	Gui.frmNotes.GsGCNotes.SetColumnProperty("gvSHNotes","CREATE_DT","DisplayCustomDatetime","d")
	Gui.frmNotes.GsGCNotes.ResumeLayout()

	Gui.frmNotes..Visible(True)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGvSHNotes.End

Program.Sub.frmNotes_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmNotes..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmNotes_UnLoad.End

Program.Sub.GsGCNotes_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sText.Declare
	V.Local.sSQL.Declare

	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("NOTES")
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sText)
			F.Intrinsic.String.Build("Update GAB_6572_NOTES Set Notes = '{0}' Where NID = {1};",V.Local.sText,V.DataTable.dtSHNotes(V.Args.RowIndex).NID!FieldVal,V.Local.sSQL)
			F.ODBC.Connection!con.OpenCompanyConnection(300)
			F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.ODBC.Connection!con.Close
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCNotes_CellValueChanged.End

Program.Sub.CheckDefault.Start
	V.Local.sRegistry.Declare
	
	F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"CRM OPTION",6572,0,5,"",V.Local.sRegistry)
	F.Intrinsic.Control.If(V.Local.sRegistry,<>,"")
		Gui.frmCRM.ddlOpts.Text(V.Local.sRegistry)
	F.Intrinsic.Control.EndIf
Program.Sub.CheckDefault.End

Program.Sub.cmdLoadData_Click.Start
	F.Intrinsic.Control.CallSub(LoadData)
Program.Sub.cmdLoadData_Click.End
Program.Sub.ddlOpts_SelectedIndexChanged.Start
Program.Sub.ddlOpts_SelectedIndexChanged.End

Program.Sub.Comments.Start
${$5$}$2.0.0.0$}$2
${$6$}$acollins$}$20220104170041225$}$h98hERc2yV72q0GaUGlwSaoK/aefTdVk/XotSp2jZHi72eA1oPmzM7GGp5p8N2IQwmE3BCufVjYOf7g3i3GWYw==
Program.Sub.Comments.End